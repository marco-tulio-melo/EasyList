{"code":"!function(e){var t={};function n(r){if(t[r])return t[r].exports;var i=t[r]={i:r,l:!1,exports:{}};return e[r].call(i.exports,i,i.exports,n),i.l=!0,i.exports}n.m=e,n.c=t,n.d=function(e,t,r){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},n.r=function(e){\"undefined\"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:\"Module\"}),Object.defineProperty(e,\"__esModule\",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&\"object\"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,\"default\",{enumerable:!0,value:e}),2&t&&\"string\"!=typeof e)for(var i in e)n.d(r,i,function(t){return e[t]}.bind(null,i));return r},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,\"a\",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p=\"\",n(n.s=1)}([function(e,t,n){\n/*! 4.20.3 / Consumer  */\nvar r;r=function(){return function(e){var t={};function n(r){if(t[r])return t[r].exports;var i=t[r]={exports:{},id:r,loaded:!1};return e[r].call(i.exports,i,i.exports,n),i.loaded=!0,i.exports}return n.m=e,n.c=t,n.p=\"\",n(0)}([function(e,t,n){\"use strict\";Object.defineProperty(t,\"__esModule\",{value:!0});var r=a(n(1)),i=a(n(39)),s=a(n(40)),o=n(41);n(5);function a(e){return e&&e.__esModule?e:{default:e}}function u(e){if(!navigator||!navigator.sendBeacon)return!1;navigator.sendBeacon(e)}var c=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError(\"Cannot call a class as a function\")}(this,t);var n=e.listenToBrowserNetworkEvents,r=void 0===n||n;e.db=s.default,e.sdkFamily=\"Web\",e.networking=new i.default({del:o.del,get:o.get,post:o.post,sendBeacon:u});var a=function(e,t){if(!e)throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\");return!t||\"object\"!=typeof t&&\"function\"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return r&&(window.addEventListener(\"offline\",function(){a.networkDownDetected()}),window.addEventListener(\"online\",function(){a.networkUpDetected()})),a}return function(e,t){if(\"function\"!=typeof t&&null!==t)throw new TypeError(\"Super expression must either be null or a function, not \"+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,r.default),t}();t.default=c,e.exports=t.default},function(e,t,n){\"use strict\";Object.defineProperty(t,\"__esModule\",{value:!0});var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,\"value\"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=I(n(2)),s=I(n(6)),o=I(n(8)),a=I(n(9)),u=I(n(16)),c=N(n(17)),l=N(n(18)),d=N(n(19)),h=N(n(20)),p=N(n(21)),f=N(n(22)),g=N(n(23)),m=N(n(24)),y=N(n(25)),v=N(n(26)),_=N(n(27)),b=N(n(28)),w=N(n(29)),C=N(n(30)),k=N(n(31)),S=N(n(32)),P=N(n(33)),x=N(n(34)),T=N(n(35)),E=N(n(36)),O=N(n(37)),M=N(n(12)),A=N(n(38)),j=I(n(13)),q=I(n(10)),L=(n(5),I(n(3)));function N(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}function I(e){return e&&e.__esModule?e:{default:e}}var D=function(){function e(t){var n=this;!function(e,t){if(!(e instanceof t))throw new TypeError(\"Cannot call a class as a function\")}(this,e);var r=t.db,j=t.networking,q=this._config=new i.default({setup:t,db:r}),L=new s.default({config:q});j.init(q);var N={config:q,networking:j,crypto:L},I=u.default.bind(this,N,M),D=u.default.bind(this,N,v),R=u.default.bind(this,N,b),U=u.default.bind(this,N,C),H=u.default.bind(this,N,A),K=this._listenerManager=new a.default,B=new o.default({timeEndpoint:I,leaveEndpoint:D,heartbeatEndpoint:R,setStateEndpoint:U,subscribeEndpoint:H,crypto:N.crypto,config:N.config,listenerManager:K});this.addListener=K.addListener.bind(K),this.removeListener=K.removeListener.bind(K),this.removeAllListeners=K.removeAllListeners.bind(K),this.channelGroups={listGroups:u.default.bind(this,N,h),listChannels:u.default.bind(this,N,p),addChannels:u.default.bind(this,N,c),removeChannels:u.default.bind(this,N,l),deleteGroup:u.default.bind(this,N,d)},this.push={addChannels:u.default.bind(this,N,f),removeChannels:u.default.bind(this,N,g),deleteDevice:u.default.bind(this,N,y),listChannels:u.default.bind(this,N,m)},this.hereNow=u.default.bind(this,N,k),this.whereNow=u.default.bind(this,N,_),this.getState=u.default.bind(this,N,w),this.setState=B.adaptStateChange.bind(B),this.grant=u.default.bind(this,N,P),this.audit=u.default.bind(this,N,S),this.publish=u.default.bind(this,N,x),this.fire=function(e,t){return e.replicate=!1,e.storeInHistory=!1,n.publish(e,t)},this.history=u.default.bind(this,N,T),this.deleteMessages=u.default.bind(this,N,E),this.fetchMessages=u.default.bind(this,N,O),this.time=I,this.subscribe=B.adaptSubscribeChange.bind(B),this.presence=B.adaptPresenceChange.bind(B),this.unsubscribe=B.adaptUnsubscribeChange.bind(B),this.disconnect=B.disconnect.bind(B),this.reconnect=B.reconnect.bind(B),this.destroy=function(e){B.unsubscribeAll(e),B.disconnect()},this.stop=this.destroy,this.unsubscribeAll=B.unsubscribeAll.bind(B),this.getSubscribedChannels=B.getSubscribedChannels.bind(B),this.getSubscribedChannelGroups=B.getSubscribedChannelGroups.bind(B),this.encrypt=L.encrypt.bind(L),this.decrypt=L.decrypt.bind(L),this.getAuthKey=N.config.getAuthKey.bind(N.config),this.setAuthKey=N.config.setAuthKey.bind(N.config),this.setCipherKey=N.config.setCipherKey.bind(N.config),this.getUUID=N.config.getUUID.bind(N.config),this.setUUID=N.config.setUUID.bind(N.config),this.getFilterExpression=N.config.getFilterExpression.bind(N.config),this.setFilterExpression=N.config.setFilterExpression.bind(N.config),this.setHeartbeatInterval=N.config.setHeartbeatInterval.bind(N.config),j.hasModule(\"proxy\")&&(this.setProxy=function(e){N.config.setProxy(e),n.reconnect()})}return r(e,[{key:\"getVersion\",value:function(){return this._config.getVersion()}},{key:\"networkDownDetected\",value:function(){this._listenerManager.announceNetworkDown(),this._config.restore?this.disconnect():this.destroy(!0)}},{key:\"networkUpDetected\",value:function(){this._listenerManager.announceNetworkUp(),this.reconnect()}}],[{key:\"generateUUID\",value:function(){return L.default.createUUID()}}]),e}();D.OPERATIONS=j.default,D.CATEGORIES=q.default,t.default=D,e.exports=t.default},function(e,t,n){\"use strict\";Object.defineProperty(t,\"__esModule\",{value:!0});var r,i=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,\"value\"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),s=n(3),o=(r=s)&&r.__esModule?r:{default:r};n(5);var a=function(){function e(t){var n=t.setup,r=t.db;!function(e,t){if(!(e instanceof t))throw new TypeError(\"Cannot call a class as a function\")}(this,e),this._db=r,this.instanceId=\"pn-\"+o.default.createUUID(),this.secretKey=n.secretKey||n.secret_key,this.subscribeKey=n.subscribeKey||n.subscribe_key,this.publishKey=n.publishKey||n.publish_key,this.sdkName=n.sdkName,this.sdkFamily=n.sdkFamily,this.partnerId=n.partnerId,this.setAuthKey(n.authKey),this.setCipherKey(n.cipherKey),this.setFilterExpression(n.filterExpression),this.origin=n.origin||\"pubsub.pndsn.com\",this.secure=n.ssl||!1,this.restore=n.restore||!1,this.proxy=n.proxy,this.keepAlive=n.keepAlive,this.keepAliveSettings=n.keepAliveSettings,this.autoNetworkDetection=n.autoNetworkDetection||!1,this.dedupeOnSubscribe=n.dedupeOnSubscribe||!1,this.maximumCacheSize=n.maximumCacheSize||100,this.customEncrypt=n.customEncrypt,this.customDecrypt=n.customDecrypt,\"undefined\"!=typeof location&&\"https:\"===location.protocol&&(this.secure=!0),this.logVerbosity=n.logVerbosity||!1,this.suppressLeaveEvents=n.suppressLeaveEvents||!1,this.announceFailedHeartbeats=n.announceFailedHeartbeats||!0,this.announceSuccessfulHeartbeats=n.announceSuccessfulHeartbeats||!1,this.useInstanceId=n.useInstanceId||!1,this.useRequestId=n.useRequestId||!1,this.requestMessageCountThreshold=n.requestMessageCountThreshold,this.setTransactionTimeout(n.transactionalRequestTimeout||15e3),this.setSubscribeTimeout(n.subscribeRequestTimeout||31e4),this.setSendBeaconConfig(n.useSendBeacon||!0),this.setPresenceTimeout(n.presenceTimeout||300),null!=n.heartbeatInterval&&this.setHeartbeatInterval(n.heartbeatInterval),this.setUUID(this._decideUUID(n.uuid))}return i(e,[{key:\"getAuthKey\",value:function(){return this.authKey}},{key:\"setAuthKey\",value:function(e){return this.authKey=e,this}},{key:\"setCipherKey\",value:function(e){return this.cipherKey=e,this}},{key:\"getUUID\",value:function(){return this.UUID}},{key:\"setUUID\",value:function(e){return this._db&&this._db.set&&this._db.set(this.subscribeKey+\"uuid\",e),this.UUID=e,this}},{key:\"getFilterExpression\",value:function(){return this.filterExpression}},{key:\"setFilterExpression\",value:function(e){return this.filterExpression=e,this}},{key:\"getPresenceTimeout\",value:function(){return this._presenceTimeout}},{key:\"setPresenceTimeout\",value:function(e){return this._presenceTimeout=e,this.setHeartbeatInterval(this._presenceTimeout/2-1),this}},{key:\"setProxy\",value:function(e){this.proxy=e}},{key:\"getHeartbeatInterval\",value:function(){return this._heartbeatInterval}},{key:\"setHeartbeatInterval\",value:function(e){return this._heartbeatInterval=e,this}},{key:\"getSubscribeTimeout\",value:function(){return this._subscribeRequestTimeout}},{key:\"setSubscribeTimeout\",value:function(e){return this._subscribeRequestTimeout=e,this}},{key:\"getTransactionTimeout\",value:function(){return this._transactionalRequestTimeout}},{key:\"setTransactionTimeout\",value:function(e){return this._transactionalRequestTimeout=e,this}},{key:\"isSendBeaconEnabled\",value:function(){return this._useSendBeacon}},{key:\"setSendBeaconConfig\",value:function(e){return this._useSendBeacon=e,this}},{key:\"getVersion\",value:function(){return\"4.20.3\"}},{key:\"_decideUUID\",value:function(e){return e||(this._db&&this._db.get&&this._db.get(this.subscribeKey+\"uuid\")?this._db.get(this.subscribeKey+\"uuid\"):\"pn-\"+o.default.createUUID())}}]),e}();t.default=a,e.exports=t.default},function(e,t,n){\"use strict\";Object.defineProperty(t,\"__esModule\",{value:!0});var r,i=n(4),s=(r=i)&&r.__esModule?r:{default:r};t.default={createUUID:function(){return s.default.uuid?s.default.uuid():(0,s.default)()}},e.exports=t.default},function(e,t,n){var r,i,s;/*! lil-uuid - v0.1 - MIT License - https://github.com/lil-js/uuid */i=[t],void 0===(s=\"function\"==typeof(r=function(e){var t={3:/^[0-9A-F]{8}-[0-9A-F]{4}-3[0-9A-F]{3}-[0-9A-F]{4}-[0-9A-F]{12}$/i,4:/^[0-9A-F]{8}-[0-9A-F]{4}-4[0-9A-F]{3}-[89AB][0-9A-F]{3}-[0-9A-F]{12}$/i,5:/^[0-9A-F]{8}-[0-9A-F]{4}-5[0-9A-F]{3}-[89AB][0-9A-F]{3}-[0-9A-F]{12}$/i,all:/^[0-9A-F]{8}-[0-9A-F]{4}-[0-9A-F]{4}-[0-9A-F]{4}-[0-9A-F]{12}$/i};function n(){var e,t,n=\"\";for(e=0;e<32;e++)t=16*Math.random()|0,8!==e&&12!==e&&16!==e&&20!==e||(n+=\"-\"),n+=(12===e?4:16===e?3&t|8:t).toString(16);return n}function r(e,n){var r=t[n||\"all\"];return r&&r.test(e)||!1}n.isUUID=r,n.VERSION=\"0.1.0\",e.uuid=n,e.isUUID=r})?r.apply(t,i):r)||(e.exports=s)},function(e,t){\"use strict\";e.exports={}},function(e,t,n){\"use strict\";Object.defineProperty(t,\"__esModule\",{value:!0});var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,\"value\"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=(s(n(2)),s(n(7)));function s(e){return e&&e.__esModule?e:{default:e}}var o=function(){function e(t){var n=t.config;!function(e,t){if(!(e instanceof t))throw new TypeError(\"Cannot call a class as a function\")}(this,e),this._config=n,this._iv=\"0123456789012345\",this._allowedKeyEncodings=[\"hex\",\"utf8\",\"base64\",\"binary\"],this._allowedKeyLengths=[128,256],this._allowedModes=[\"ecb\",\"cbc\"],this._defaultOptions={encryptKey:!0,keyEncoding:\"utf8\",keyLength:256,mode:\"cbc\"}}return r(e,[{key:\"HMACSHA256\",value:function(e){return i.default.HmacSHA256(e,this._config.secretKey).toString(i.default.enc.Base64)}},{key:\"SHA256\",value:function(e){return i.default.SHA256(e).toString(i.default.enc.Hex)}},{key:\"_parseOptions\",value:function(e){var t=e||{};return t.hasOwnProperty(\"encryptKey\")||(t.encryptKey=this._defaultOptions.encryptKey),t.hasOwnProperty(\"keyEncoding\")||(t.keyEncoding=this._defaultOptions.keyEncoding),t.hasOwnProperty(\"keyLength\")||(t.keyLength=this._defaultOptions.keyLength),t.hasOwnProperty(\"mode\")||(t.mode=this._defaultOptions.mode),-1===this._allowedKeyEncodings.indexOf(t.keyEncoding.toLowerCase())&&(t.keyEncoding=this._defaultOptions.keyEncoding),-1===this._allowedKeyLengths.indexOf(parseInt(t.keyLength,10))&&(t.keyLength=this._defaultOptions.keyLength),-1===this._allowedModes.indexOf(t.mode.toLowerCase())&&(t.mode=this._defaultOptions.mode),t}},{key:\"_decodeKey\",value:function(e,t){return\"base64\"===t.keyEncoding?i.default.enc.Base64.parse(e):\"hex\"===t.keyEncoding?i.default.enc.Hex.parse(e):e}},{key:\"_getPaddedKey\",value:function(e,t){return e=this._decodeKey(e,t),t.encryptKey?i.default.enc.Utf8.parse(this.SHA256(e).slice(0,32)):e}},{key:\"_getMode\",value:function(e){return\"ecb\"===e.mode?i.default.mode.ECB:i.default.mode.CBC}},{key:\"_getIV\",value:function(e){return\"cbc\"===e.mode?i.default.enc.Utf8.parse(this._iv):null}},{key:\"encrypt\",value:function(e,t,n){return this._config.customEncrypt?this._config.customEncrypt(e):this.pnEncrypt(e,t,n)}},{key:\"decrypt\",value:function(e,t,n){return this._config.customDecrypt?this._config.customDecrypt(e):this.pnDecrypt(e,t,n)}},{key:\"pnEncrypt\",value:function(e,t,n){if(!t&&!this._config.cipherKey)return e;n=this._parseOptions(n);var r=this._getIV(n),s=this._getMode(n),o=this._getPaddedKey(t||this._config.cipherKey,n);return i.default.AES.encrypt(e,o,{iv:r,mode:s}).ciphertext.toString(i.default.enc.Base64)||e}},{key:\"pnDecrypt\",value:function(e,t,n){if(!t&&!this._config.cipherKey)return e;n=this._parseOptions(n);var r=this._getIV(n),s=this._getMode(n),o=this._getPaddedKey(t||this._config.cipherKey,n);try{var a=i.default.enc.Base64.parse(e),u=i.default.AES.decrypt({ciphertext:a},o,{iv:r,mode:s}).toString(i.default.enc.Utf8);return JSON.parse(u)}catch(e){return null}}}]),e}();t.default=o,e.exports=t.default},function(e,t){\"use strict\";var n,r,i,s,o,a=a||function(e,t){var n={},r=n.lib={},i=function(){},s=r.Base={extend:function(e){i.prototype=this;var t=new i;return e&&t.mixIn(e),t.hasOwnProperty(\"init\")||(t.init=function(){t.$super.init.apply(this,arguments)}),t.init.prototype=t,t.$super=this,t},create:function(){var e=this.extend();return e.init.apply(e,arguments),e},init:function(){},mixIn:function(e){for(var t in e)e.hasOwnProperty(t)&&(this[t]=e[t]);e.hasOwnProperty(\"toString\")&&(this.toString=e.toString)},clone:function(){return this.init.prototype.extend(this)}},o=r.WordArray=s.extend({init:function(e,t){e=this.words=e||[],this.sigBytes=null!=t?t:4*e.length},toString:function(e){return(e||u).stringify(this)},concat:function(e){var t=this.words,n=e.words,r=this.sigBytes;if(e=e.sigBytes,this.clamp(),r%4)for(var i=0;i<e;i++)t[r+i>>>2]|=(n[i>>>2]>>>24-i%4*8&255)<<24-(r+i)%4*8;else if(65535<n.length)for(i=0;i<e;i+=4)t[r+i>>>2]=n[i>>>2];else t.push.apply(t,n);return this.sigBytes+=e,this},clamp:function(){var t=this.words,n=this.sigBytes;t[n>>>2]&=4294967295<<32-n%4*8,t.length=e.ceil(n/4)},clone:function(){var e=s.clone.call(this);return e.words=this.words.slice(0),e},random:function(t){for(var n=[],r=0;r<t;r+=4)n.push(4294967296*e.random()|0);return new o.init(n,t)}}),a=n.enc={},u=a.Hex={stringify:function(e){var t=e.words;e=e.sigBytes;for(var n=[],r=0;r<e;r++){var i=t[r>>>2]>>>24-r%4*8&255;n.push((i>>>4).toString(16)),n.push((15&i).toString(16))}return n.join(\"\")},parse:function(e){for(var t=e.length,n=[],r=0;r<t;r+=2)n[r>>>3]|=parseInt(e.substr(r,2),16)<<24-r%8*4;return new o.init(n,t/2)}},c=a.Latin1={stringify:function(e){var t=e.words;e=e.sigBytes;for(var n=[],r=0;r<e;r++)n.push(String.fromCharCode(t[r>>>2]>>>24-r%4*8&255));return n.join(\"\")},parse:function(e){for(var t=e.length,n=[],r=0;r<t;r++)n[r>>>2]|=(255&e.charCodeAt(r))<<24-r%4*8;return new o.init(n,t)}},l=a.Utf8={stringify:function(e){try{return decodeURIComponent(escape(c.stringify(e)))}catch(e){throw Error(\"Malformed UTF-8 data\")}},parse:function(e){return c.parse(unescape(encodeURIComponent(e)))}},d=r.BufferedBlockAlgorithm=s.extend({reset:function(){this._data=new o.init,this._nDataBytes=0},_append:function(e){\"string\"==typeof e&&(e=l.parse(e)),this._data.concat(e),this._nDataBytes+=e.sigBytes},_process:function(t){var n=this._data,r=n.words,i=n.sigBytes,s=this.blockSize,a=i/(4*s);if(t=(a=t?e.ceil(a):e.max((0|a)-this._minBufferSize,0))*s,i=e.min(4*t,i),t){for(var u=0;u<t;u+=s)this._doProcessBlock(r,u);u=r.splice(0,t),n.sigBytes-=i}return new o.init(u,i)},clone:function(){var e=s.clone.call(this);return e._data=this._data.clone(),e},_minBufferSize:0});r.Hasher=d.extend({cfg:s.extend(),init:function(e){this.cfg=this.cfg.extend(e),this.reset()},reset:function(){d.reset.call(this),this._doReset()},update:function(e){return this._append(e),this._process(),this},finalize:function(e){return e&&this._append(e),this._doFinalize()},blockSize:16,_createHelper:function(e){return function(t,n){return new e.init(n).finalize(t)}},_createHmacHelper:function(e){return function(t,n){return new h.HMAC.init(e,n).finalize(t)}}});var h=n.algo={};return n}(Math);!function(e){for(var t=a,n=(i=t.lib).WordArray,r=i.Hasher,i=t.algo,s=[],o=[],u=function(e){return 4294967296*(e-(0|e))|0},c=2,l=0;64>l;){var d;e:{d=c;for(var h=e.sqrt(d),p=2;p<=h;p++)if(!(d%p)){d=!1;break e}d=!0}d&&(8>l&&(s[l]=u(e.pow(c,.5))),o[l]=u(e.pow(c,1/3)),l++),c++}var f=[];i=i.SHA256=r.extend({_doReset:function(){this._hash=new n.init(s.slice(0))},_doProcessBlock:function(e,t){for(var n=this._hash.words,r=n[0],i=n[1],s=n[2],a=n[3],u=n[4],c=n[5],l=n[6],d=n[7],h=0;64>h;h++){if(16>h)f[h]=0|e[t+h];else{var p=f[h-15],g=f[h-2];f[h]=((p<<25|p>>>7)^(p<<14|p>>>18)^p>>>3)+f[h-7]+((g<<15|g>>>17)^(g<<13|g>>>19)^g>>>10)+f[h-16]}p=d+((u<<26|u>>>6)^(u<<21|u>>>11)^(u<<7|u>>>25))+(u&c^~u&l)+o[h]+f[h],g=((r<<30|r>>>2)^(r<<19|r>>>13)^(r<<10|r>>>22))+(r&i^r&s^i&s),d=l,l=c,c=u,u=a+p|0,a=s,s=i,i=r,r=p+g|0}n[0]=n[0]+r|0,n[1]=n[1]+i|0,n[2]=n[2]+s|0,n[3]=n[3]+a|0,n[4]=n[4]+u|0,n[5]=n[5]+c|0,n[6]=n[6]+l|0,n[7]=n[7]+d|0},_doFinalize:function(){var t=this._data,n=t.words,r=8*this._nDataBytes,i=8*t.sigBytes;return n[i>>>5]|=128<<24-i%32,n[14+(i+64>>>9<<4)]=e.floor(r/4294967296),n[15+(i+64>>>9<<4)]=r,t.sigBytes=4*n.length,this._process(),this._hash},clone:function(){var e=r.clone.call(this);return e._hash=this._hash.clone(),e}});t.SHA256=r._createHelper(i),t.HmacSHA256=r._createHmacHelper(i)}(Math),r=(n=a).enc.Utf8,n.algo.HMAC=n.lib.Base.extend({init:function(e,t){e=this._hasher=new e.init,\"string\"==typeof t&&(t=r.parse(t));var n=e.blockSize,i=4*n;t.sigBytes>i&&(t=e.finalize(t)),t.clamp();for(var s=this._oKey=t.clone(),o=this._iKey=t.clone(),a=s.words,u=o.words,c=0;c<n;c++)a[c]^=1549556828,u[c]^=909522486;s.sigBytes=o.sigBytes=i,this.reset()},reset:function(){var e=this._hasher;e.reset(),e.update(this._iKey)},update:function(e){return this._hasher.update(e),this},finalize:function(e){var t=this._hasher;return e=t.finalize(e),t.reset(),t.finalize(this._oKey.clone().concat(e))}}),s=(i=a).lib.WordArray,i.enc.Base64={stringify:function(e){var t=e.words,n=e.sigBytes,r=this._map;e.clamp(),e=[];for(var i=0;i<n;i+=3)for(var s=(t[i>>>2]>>>24-i%4*8&255)<<16|(t[i+1>>>2]>>>24-(i+1)%4*8&255)<<8|t[i+2>>>2]>>>24-(i+2)%4*8&255,o=0;4>o&&i+.75*o<n;o++)e.push(r.charAt(s>>>6*(3-o)&63));if(t=r.charAt(64))for(;e.length%4;)e.push(t);return e.join(\"\")},parse:function(e){var t=e.length,n=this._map;(r=n.charAt(64))&&-1!=(r=e.indexOf(r))&&(t=r);for(var r=[],i=0,o=0;o<t;o++)if(o%4){var a=n.indexOf(e.charAt(o-1))<<o%4*2,u=n.indexOf(e.charAt(o))>>>6-o%4*2;r[i>>>2]|=(a|u)<<24-i%4*8,i++}return s.create(r,i)},_map:\"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=\"},function(e){function t(e,t,n,r,i,s,o){return((e=e+(t&n|~t&r)+i+o)<<s|e>>>32-s)+t}function n(e,t,n,r,i,s,o){return((e=e+(t&r|n&~r)+i+o)<<s|e>>>32-s)+t}function r(e,t,n,r,i,s,o){return((e=e+(t^n^r)+i+o)<<s|e>>>32-s)+t}function i(e,t,n,r,i,s,o){return((e=e+(n^(t|~r))+i+o)<<s|e>>>32-s)+t}for(var s=a,o=(c=s.lib).WordArray,u=c.Hasher,c=s.algo,l=[],d=0;64>d;d++)l[d]=4294967296*e.abs(e.sin(d+1))|0;c=c.MD5=u.extend({_doReset:function(){this._hash=new o.init([1732584193,4023233417,2562383102,271733878])},_doProcessBlock:function(e,s){for(var o=0;16>o;o++){var a=e[u=s+o];e[u]=16711935&(a<<8|a>>>24)|4278255360&(a<<24|a>>>8)}o=this._hash.words;var u=e[s+0],c=(a=e[s+1],e[s+2]),d=e[s+3],h=e[s+4],p=e[s+5],f=e[s+6],g=e[s+7],m=e[s+8],y=e[s+9],v=e[s+10],_=e[s+11],b=e[s+12],w=e[s+13],C=e[s+14],k=e[s+15],S=t(S=o[0],T=o[1],x=o[2],P=o[3],u,7,l[0]),P=t(P,S,T,x,a,12,l[1]),x=t(x,P,S,T,c,17,l[2]),T=t(T,x,P,S,d,22,l[3]);S=t(S,T,x,P,h,7,l[4]),P=t(P,S,T,x,p,12,l[5]),x=t(x,P,S,T,f,17,l[6]),T=t(T,x,P,S,g,22,l[7]),S=t(S,T,x,P,m,7,l[8]),P=t(P,S,T,x,y,12,l[9]),x=t(x,P,S,T,v,17,l[10]),T=t(T,x,P,S,_,22,l[11]),S=t(S,T,x,P,b,7,l[12]),P=t(P,S,T,x,w,12,l[13]),x=t(x,P,S,T,C,17,l[14]),S=n(S,T=t(T,x,P,S,k,22,l[15]),x,P,a,5,l[16]),P=n(P,S,T,x,f,9,l[17]),x=n(x,P,S,T,_,14,l[18]),T=n(T,x,P,S,u,20,l[19]),S=n(S,T,x,P,p,5,l[20]),P=n(P,S,T,x,v,9,l[21]),x=n(x,P,S,T,k,14,l[22]),T=n(T,x,P,S,h,20,l[23]),S=n(S,T,x,P,y,5,l[24]),P=n(P,S,T,x,C,9,l[25]),x=n(x,P,S,T,d,14,l[26]),T=n(T,x,P,S,m,20,l[27]),S=n(S,T,x,P,w,5,l[28]),P=n(P,S,T,x,c,9,l[29]),x=n(x,P,S,T,g,14,l[30]),S=r(S,T=n(T,x,P,S,b,20,l[31]),x,P,p,4,l[32]),P=r(P,S,T,x,m,11,l[33]),x=r(x,P,S,T,_,16,l[34]),T=r(T,x,P,S,C,23,l[35]),S=r(S,T,x,P,a,4,l[36]),P=r(P,S,T,x,h,11,l[37]),x=r(x,P,S,T,g,16,l[38]),T=r(T,x,P,S,v,23,l[39]),S=r(S,T,x,P,w,4,l[40]),P=r(P,S,T,x,u,11,l[41]),x=r(x,P,S,T,d,16,l[42]),T=r(T,x,P,S,f,23,l[43]),S=r(S,T,x,P,y,4,l[44]),P=r(P,S,T,x,b,11,l[45]),x=r(x,P,S,T,k,16,l[46]),S=i(S,T=r(T,x,P,S,c,23,l[47]),x,P,u,6,l[48]),P=i(P,S,T,x,g,10,l[49]),x=i(x,P,S,T,C,15,l[50]),T=i(T,x,P,S,p,21,l[51]),S=i(S,T,x,P,b,6,l[52]),P=i(P,S,T,x,d,10,l[53]),x=i(x,P,S,T,v,15,l[54]),T=i(T,x,P,S,a,21,l[55]),S=i(S,T,x,P,m,6,l[56]),P=i(P,S,T,x,k,10,l[57]),x=i(x,P,S,T,f,15,l[58]),T=i(T,x,P,S,w,21,l[59]),S=i(S,T,x,P,h,6,l[60]),P=i(P,S,T,x,_,10,l[61]),x=i(x,P,S,T,c,15,l[62]),T=i(T,x,P,S,y,21,l[63]);o[0]=o[0]+S|0,o[1]=o[1]+T|0,o[2]=o[2]+x|0,o[3]=o[3]+P|0},_doFinalize:function(){var t=this._data,n=t.words,r=8*this._nDataBytes,i=8*t.sigBytes;n[i>>>5]|=128<<24-i%32;var s=e.floor(r/4294967296);for(n[15+(i+64>>>9<<4)]=16711935&(s<<8|s>>>24)|4278255360&(s<<24|s>>>8),n[14+(i+64>>>9<<4)]=16711935&(r<<8|r>>>24)|4278255360&(r<<24|r>>>8),t.sigBytes=4*(n.length+1),this._process(),n=(t=this._hash).words,r=0;4>r;r++)i=n[r],n[r]=16711935&(i<<8|i>>>24)|4278255360&(i<<24|i>>>8);return t},clone:function(){var e=u.clone.call(this);return e._hash=this._hash.clone(),e}}),s.MD5=u._createHelper(c),s.HmacMD5=u._createHmacHelper(c)}(Math),function(){var e,t=a,n=(e=t.lib).Base,r=e.WordArray,i=(e=t.algo).EvpKDF=n.extend({cfg:n.extend({keySize:4,hasher:e.MD5,iterations:1}),init:function(e){this.cfg=this.cfg.extend(e)},compute:function(e,t){for(var n=(a=this.cfg).hasher.create(),i=r.create(),s=i.words,o=a.keySize,a=a.iterations;s.length<o;){u&&n.update(u);var u=n.update(e).finalize(t);n.reset();for(var c=1;c<a;c++)u=n.finalize(u),n.reset();i.concat(u)}return i.sigBytes=4*o,i}});t.EvpKDF=function(e,t,n){return i.create(n).compute(e,t)}}(),a.lib.Cipher||function(e){var t=(f=a).lib,n=t.Base,r=t.WordArray,i=t.BufferedBlockAlgorithm,s=f.enc.Base64,o=f.algo.EvpKDF,u=t.Cipher=i.extend({cfg:n.extend(),createEncryptor:function(e,t){return this.create(this._ENC_XFORM_MODE,e,t)},createDecryptor:function(e,t){return this.create(this._DEC_XFORM_MODE,e,t)},init:function(e,t,n){this.cfg=this.cfg.extend(n),this._xformMode=e,this._key=t,this.reset()},reset:function(){i.reset.call(this),this._doReset()},process:function(e){return this._append(e),this._process()},finalize:function(e){return e&&this._append(e),this._doFinalize()},keySize:4,ivSize:4,_ENC_XFORM_MODE:1,_DEC_XFORM_MODE:2,_createHelper:function(e){return{encrypt:function(t,n,r){return(\"string\"==typeof n?g:p).encrypt(e,t,n,r)},decrypt:function(t,n,r){return(\"string\"==typeof n?g:p).decrypt(e,t,n,r)}}}});t.StreamCipher=u.extend({_doFinalize:function(){return this._process(!0)},blockSize:1});var c=f.mode={},l=function(e,t,n){var r=this._iv;r?this._iv=void 0:r=this._prevBlock;for(var i=0;i<n;i++)e[t+i]^=r[i]},d=(t.BlockCipherMode=n.extend({createEncryptor:function(e,t){return this.Encryptor.create(e,t)},createDecryptor:function(e,t){return this.Decryptor.create(e,t)},init:function(e,t){this._cipher=e,this._iv=t}})).extend();d.Encryptor=d.extend({processBlock:function(e,t){var n=this._cipher,r=n.blockSize;l.call(this,e,t,r),n.encryptBlock(e,t),this._prevBlock=e.slice(t,t+r)}}),d.Decryptor=d.extend({processBlock:function(e,t){var n=this._cipher,r=n.blockSize,i=e.slice(t,t+r);n.decryptBlock(e,t),l.call(this,e,t,r),this._prevBlock=i}}),c=c.CBC=d,d=(f.pad={}).Pkcs7={pad:function(e,t){for(var n,i=(n=(n=4*t)-e.sigBytes%n)<<24|n<<16|n<<8|n,s=[],o=0;o<n;o+=4)s.push(i);n=r.create(s,n),e.concat(n)},unpad:function(e){e.sigBytes-=255&e.words[e.sigBytes-1>>>2]}},t.BlockCipher=u.extend({cfg:u.cfg.extend({mode:c,padding:d}),reset:function(){u.reset.call(this);var e=(t=this.cfg).iv,t=t.mode;if(this._xformMode==this._ENC_XFORM_MODE)var n=t.createEncryptor;else n=t.createDecryptor,this._minBufferSize=1;this._mode=n.call(t,this,e&&e.words)},_doProcessBlock:function(e,t){this._mode.processBlock(e,t)},_doFinalize:function(){var e=this.cfg.padding;if(this._xformMode==this._ENC_XFORM_MODE){e.pad(this._data,this.blockSize);var t=this._process(!0)}else t=this._process(!0),e.unpad(t);return t},blockSize:4});var h=t.CipherParams=n.extend({init:function(e){this.mixIn(e)},toString:function(e){return(e||this.formatter).stringify(this)}}),p=(c=(f.format={}).OpenSSL={stringify:function(e){var t=e.ciphertext;return((e=e.salt)?r.create([1398893684,1701076831]).concat(e).concat(t):t).toString(s)},parse:function(e){var t=(e=s.parse(e)).words;if(1398893684==t[0]&&1701076831==t[1]){var n=r.create(t.slice(2,4));t.splice(0,4),e.sigBytes-=16}return h.create({ciphertext:e,salt:n})}},t.SerializableCipher=n.extend({cfg:n.extend({format:c}),encrypt:function(e,t,n,r){r=this.cfg.extend(r);var i=e.createEncryptor(n,r);return t=i.finalize(t),i=i.cfg,h.create({ciphertext:t,key:n,iv:i.iv,algorithm:e,mode:i.mode,padding:i.padding,blockSize:e.blockSize,formatter:r.format})},decrypt:function(e,t,n,r){return r=this.cfg.extend(r),t=this._parse(t,r.format),e.createDecryptor(n,r).finalize(t.ciphertext)},_parse:function(e,t){return\"string\"==typeof e?t.parse(e,this):e}})),f=(f.kdf={}).OpenSSL={execute:function(e,t,n,i){return i||(i=r.random(8)),e=o.create({keySize:t+n}).compute(e,i),n=r.create(e.words.slice(t),4*n),e.sigBytes=4*t,h.create({key:e,iv:n,salt:i})}},g=t.PasswordBasedCipher=p.extend({cfg:p.cfg.extend({kdf:f}),encrypt:function(e,t,n,r){return n=(r=this.cfg.extend(r)).kdf.execute(n,e.keySize,e.ivSize),r.iv=n.iv,(e=p.encrypt.call(this,e,t,n.key,r)).mixIn(n),e},decrypt:function(e,t,n,r){return r=this.cfg.extend(r),t=this._parse(t,r.format),n=r.kdf.execute(n,e.keySize,e.ivSize,t.salt),r.iv=n.iv,p.decrypt.call(this,e,t,n.key,r)}})}(),function(){for(var e=a,t=e.lib.BlockCipher,n=e.algo,r=[],i=[],s=[],o=[],u=[],c=[],l=[],d=[],h=[],p=[],f=[],g=0;256>g;g++)f[g]=128>g?g<<1:g<<1^283;var m=0,y=0;for(g=0;256>g;g++){var v=(v=y^y<<1^y<<2^y<<3^y<<4)>>>8^255&v^99;r[m]=v,i[v]=m;var _=f[m],b=f[_],w=f[b],C=257*f[v]^16843008*v;s[m]=C<<24|C>>>8,o[m]=C<<16|C>>>16,u[m]=C<<8|C>>>24,c[m]=C,C=16843009*w^65537*b^257*_^16843008*m,l[v]=C<<24|C>>>8,d[v]=C<<16|C>>>16,h[v]=C<<8|C>>>24,p[v]=C,m?(m=_^f[f[f[w^_]]],y^=f[f[y]]):m=y=1}var k=[0,1,2,4,8,16,32,64,128,27,54];n=n.AES=t.extend({_doReset:function(){for(var e=(n=this._key).words,t=n.sigBytes/4,n=4*((this._nRounds=t+6)+1),i=this._keySchedule=[],s=0;s<n;s++)if(s<t)i[s]=e[s];else{var o=i[s-1];s%t?6<t&&4==s%t&&(o=r[o>>>24]<<24|r[o>>>16&255]<<16|r[o>>>8&255]<<8|r[255&o]):(o=r[(o=o<<8|o>>>24)>>>24]<<24|r[o>>>16&255]<<16|r[o>>>8&255]<<8|r[255&o],o^=k[s/t|0]<<24),i[s]=i[s-t]^o}for(e=this._invKeySchedule=[],t=0;t<n;t++)s=n-t,o=t%4?i[s]:i[s-4],e[t]=4>t||4>=s?o:l[r[o>>>24]]^d[r[o>>>16&255]]^h[r[o>>>8&255]]^p[r[255&o]]},encryptBlock:function(e,t){this._doCryptBlock(e,t,this._keySchedule,s,o,u,c,r)},decryptBlock:function(e,t){var n=e[t+1];e[t+1]=e[t+3],e[t+3]=n,this._doCryptBlock(e,t,this._invKeySchedule,l,d,h,p,i),n=e[t+1],e[t+1]=e[t+3],e[t+3]=n},_doCryptBlock:function(e,t,n,r,i,s,o,a){for(var u=this._nRounds,c=e[t]^n[0],l=e[t+1]^n[1],d=e[t+2]^n[2],h=e[t+3]^n[3],p=4,f=1;f<u;f++){var g=r[c>>>24]^i[l>>>16&255]^s[d>>>8&255]^o[255&h]^n[p++],m=r[l>>>24]^i[d>>>16&255]^s[h>>>8&255]^o[255&c]^n[p++],y=r[d>>>24]^i[h>>>16&255]^s[c>>>8&255]^o[255&l]^n[p++];h=r[h>>>24]^i[c>>>16&255]^s[l>>>8&255]^o[255&d]^n[p++],c=g,l=m,d=y}g=(a[c>>>24]<<24|a[l>>>16&255]<<16|a[d>>>8&255]<<8|a[255&h])^n[p++],m=(a[l>>>24]<<24|a[d>>>16&255]<<16|a[h>>>8&255]<<8|a[255&c])^n[p++],y=(a[d>>>24]<<24|a[h>>>16&255]<<16|a[c>>>8&255]<<8|a[255&l])^n[p++],h=(a[h>>>24]<<24|a[c>>>16&255]<<16|a[l>>>8&255]<<8|a[255&d])^n[p++],e[t]=g,e[t+1]=m,e[t+2]=y,e[t+3]=h},keySize:8});e.AES=t._createHelper(n)}(),a.mode.ECB=((o=a.lib.BlockCipherMode.extend()).Encryptor=o.extend({processBlock:function(e,t){this._cipher.encryptBlock(e,t)}}),o.Decryptor=o.extend({processBlock:function(e,t){this._cipher.decryptBlock(e,t)}}),o),e.exports=a},function(e,t,n){\"use strict\";Object.defineProperty(t,\"__esModule\",{value:!0});var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,\"value\"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=(u(n(6)),u(n(2)),u(n(9)),u(n(11))),s=u(n(14)),o=u(n(15)),a=(n(5),u(n(10)));function u(e){return e&&e.__esModule?e:{default:e}}var c=function(){function e(t){var n=t.subscribeEndpoint,r=t.leaveEndpoint,o=t.heartbeatEndpoint,a=t.setStateEndpoint,u=t.timeEndpoint,c=t.config,l=t.crypto,d=t.listenerManager;!function(e,t){if(!(e instanceof t))throw new TypeError(\"Cannot call a class as a function\")}(this,e),this._listenerManager=d,this._config=c,this._leaveEndpoint=r,this._heartbeatEndpoint=o,this._setStateEndpoint=a,this._subscribeEndpoint=n,this._crypto=l,this._channels={},this._presenceChannels={},this._heartbeatChannels={},this._heartbeatChannelGroups={},this._channelGroups={},this._presenceChannelGroups={},this._pendingChannelSubscriptions=[],this._pendingChannelGroupSubscriptions=[],this._currentTimetoken=0,this._lastTimetoken=0,this._storedTimetoken=null,this._subscriptionStatusAnnounced=!1,this._isOnline=!0,this._reconnectionManager=new i.default({timeEndpoint:u}),this._dedupingManager=new s.default({config:c})}return r(e,[{key:\"adaptStateChange\",value:function(e,t){var n=this,r=e.state,i=e.channels,s=void 0===i?[]:i,o=e.channelGroups,a=void 0===o?[]:o;return s.forEach(function(e){e in n._channels&&(n._channels[e].state=r)}),a.forEach(function(e){e in n._channelGroups&&(n._channelGroups[e].state=r)}),this._setStateEndpoint({state:r,channels:s,channelGroups:a},t)}},{key:\"adaptPresenceChange\",value:function(e){var t=this,n=e.connected,r=e.channels,i=void 0===r?[]:r,s=e.channelGroups,o=void 0===s?[]:s;n?(i.forEach(function(e){t._heartbeatChannels[e]={state:{}}}),o.forEach(function(e){t._heartbeatChannelGroups[e]={state:{}}})):(i.forEach(function(e){e in t._heartbeatChannels&&delete t._heartbeatChannels[e]}),o.forEach(function(e){e in t._heartbeatChannelGroups&&delete t._heartbeatChannelGroups[e]}),!1===this._config.suppressLeaveEvents&&this._leaveEndpoint({channels:i,channelGroups:o},function(e){t._listenerManager.announceStatus(e)})),this.reconnect()}},{key:\"adaptSubscribeChange\",value:function(e){var t=this,n=e.timetoken,r=e.channels,i=void 0===r?[]:r,s=e.channelGroups,o=void 0===s?[]:s,a=e.withPresence,u=void 0!==a&&a;this._config.subscribeKey&&\"\"!==this._config.subscribeKey?(n&&(this._lastTimetoken=this._currentTimetoken,this._currentTimetoken=n),\"0\"!==this._currentTimetoken&&0!==this._currentTimetoken&&(this._storedTimetoken=this._currentTimetoken,this._currentTimetoken=0),i.forEach(function(e){t._channels[e]={state:{}},u&&(t._presenceChannels[e]={}),t._pendingChannelSubscriptions.push(e)}),o.forEach(function(e){t._channelGroups[e]={state:{}},u&&(t._presenceChannelGroups[e]={}),t._pendingChannelGroupSubscriptions.push(e)}),this._subscriptionStatusAnnounced=!1,this.reconnect()):console&&console.log&&console.log(\"subscribe key missing; aborting subscribe\")}},{key:\"adaptUnsubscribeChange\",value:function(e,t){var n=this,r=e.channels,i=void 0===r?[]:r,s=e.channelGroups,o=void 0===s?[]:s,a=[],u=[];i.forEach(function(e){e in n._channels&&(delete n._channels[e],a.push(e)),e in n._presenceChannels&&(delete n._presenceChannels[e],a.push(e))}),o.forEach(function(e){e in n._channelGroups&&(delete n._channelGroups[e],u.push(e)),e in n._presenceChannelGroups&&(delete n._channelGroups[e],u.push(e))}),0===a.length&&0===u.length||(!1!==this._config.suppressLeaveEvents||t||this._leaveEndpoint({channels:a,channelGroups:u},function(e){e.affectedChannels=a,e.affectedChannelGroups=u,e.currentTimetoken=n._currentTimetoken,e.lastTimetoken=n._lastTimetoken,n._listenerManager.announceStatus(e)}),0===Object.keys(this._channels).length&&0===Object.keys(this._presenceChannels).length&&0===Object.keys(this._channelGroups).length&&0===Object.keys(this._presenceChannelGroups).length&&(this._lastTimetoken=0,this._currentTimetoken=0,this._storedTimetoken=null,this._region=null,this._reconnectionManager.stopPolling()),this.reconnect())}},{key:\"unsubscribeAll\",value:function(e){this.adaptUnsubscribeChange({channels:this.getSubscribedChannels(),channelGroups:this.getSubscribedChannelGroups()},e)}},{key:\"getHeartbeatChannels\",value:function(){return Object.keys(this._heartbeatChannels)}},{key:\"getHeartbeatChannelGroups\",value:function(){return Object.keys(this._heartbeatChannelGroups)}},{key:\"getSubscribedChannels\",value:function(){return Object.keys(this._channels)}},{key:\"getSubscribedChannelGroups\",value:function(){return Object.keys(this._channelGroups)}},{key:\"reconnect\",value:function(){this._startSubscribeLoop(),this._registerHeartbeatTimer()}},{key:\"disconnect\",value:function(){this._stopSubscribeLoop(),this._stopHeartbeatTimer(),this._reconnectionManager.stopPolling()}},{key:\"_registerHeartbeatTimer\",value:function(){this._stopHeartbeatTimer(),0!==this._config.getHeartbeatInterval()&&(this._performHeartbeatLoop(),this._heartbeatTimer=setInterval(this._performHeartbeatLoop.bind(this),1e3*this._config.getHeartbeatInterval()))}},{key:\"_stopHeartbeatTimer\",value:function(){this._heartbeatTimer&&(clearInterval(this._heartbeatTimer),this._heartbeatTimer=null)}},{key:\"_performHeartbeatLoop\",value:function(){var e=this,t=[];t=(t=t.concat(this.getHeartbeatChannels())).concat(this.getSubscribedChannels());var n=[];n=(n=n.concat(this.getHeartbeatChannelGroups())).concat(this.getSubscribedChannelGroups());var r={};if(0!==t.length||0!==n.length){this.getSubscribedChannels().forEach(function(t){var n=e._channels[t].state;Object.keys(n).length&&(r[t]=n)}),this.getSubscribedChannelGroups().forEach(function(t){var n=e._channelGroups[t].state;Object.keys(n).length&&(r[t]=n)});this._heartbeatEndpoint({channels:t,channelGroups:n,state:r},function(t){t.error&&e._config.announceFailedHeartbeats&&e._listenerManager.announceStatus(t),t.error&&e._config.autoNetworkDetection&&e._isOnline&&(e._isOnline=!1,e.disconnect(),e._listenerManager.announceNetworkDown(),e.reconnect()),!t.error&&e._config.announceSuccessfulHeartbeats&&e._listenerManager.announceStatus(t)}.bind(this))}}},{key:\"_startSubscribeLoop\",value:function(){this._stopSubscribeLoop();var e=[],t=[];if(Object.keys(this._channels).forEach(function(t){return e.push(t)}),Object.keys(this._presenceChannels).forEach(function(t){return e.push(t+\"-pnpres\")}),Object.keys(this._channelGroups).forEach(function(e){return t.push(e)}),Object.keys(this._presenceChannelGroups).forEach(function(e){return t.push(e+\"-pnpres\")}),0!==e.length||0!==t.length){var n={channels:e,channelGroups:t,timetoken:this._currentTimetoken,filterExpression:this._config.filterExpression,region:this._region};this._subscribeCall=this._subscribeEndpoint(n,this._processSubscribeResponse.bind(this))}}},{key:\"_processSubscribeResponse\",value:function(e,t){var n=this;if(e.error)e.category===a.default.PNTimeoutCategory?this._startSubscribeLoop():e.category===a.default.PNNetworkIssuesCategory?(this.disconnect(),e.error&&this._config.autoNetworkDetection&&this._isOnline&&(this._isOnline=!1,this._listenerManager.announceNetworkDown()),this._reconnectionManager.onReconnection(function(){n._config.autoNetworkDetection&&!n._isOnline&&(n._isOnline=!0,n._listenerManager.announceNetworkUp()),n.reconnect(),n._subscriptionStatusAnnounced=!0;var t={category:a.default.PNReconnectedCategory,operation:e.operation,lastTimetoken:n._lastTimetoken,currentTimetoken:n._currentTimetoken};n._listenerManager.announceStatus(t)}),this._reconnectionManager.startPolling(),this._listenerManager.announceStatus(e)):e.category===a.default.PNBadRequestCategory?(this._stopHeartbeatTimer(),this._listenerManager.announceStatus(e)):this._listenerManager.announceStatus(e);else{if(this._storedTimetoken?(this._currentTimetoken=this._storedTimetoken,this._storedTimetoken=null):(this._lastTimetoken=this._currentTimetoken,this._currentTimetoken=t.metadata.timetoken),!this._subscriptionStatusAnnounced){var r={};r.category=a.default.PNConnectedCategory,r.operation=e.operation,r.affectedChannels=this._pendingChannelSubscriptions,r.subscribedChannels=this.getSubscribedChannels(),r.affectedChannelGroups=this._pendingChannelGroupSubscriptions,r.lastTimetoken=this._lastTimetoken,r.currentTimetoken=this._currentTimetoken,this._subscriptionStatusAnnounced=!0,this._listenerManager.announceStatus(r),this._pendingChannelSubscriptions=[],this._pendingChannelGroupSubscriptions=[]}var i=t.messages||[],s=this._config,u=s.requestMessageCountThreshold,c=s.dedupeOnSubscribe;if(u&&i.length>=u){var l={};l.category=a.default.PNRequestMessageCountExceededCategory,l.operation=e.operation,this._listenerManager.announceStatus(l)}i.forEach(function(e){var t=e.channel,r=e.subscriptionMatch,i=e.publishMetaData;if(t===r&&(r=null),c){if(n._dedupingManager.isDuplicate(e))return;n._dedupingManager.addEntry(e)}if(o.default.endsWith(e.channel,\"-pnpres\")){var s={channel:null,subscription:null};s.actualChannel=null!=r?t:null,s.subscribedChannel=null!=r?r:t,t&&(s.channel=t.substring(0,t.lastIndexOf(\"-pnpres\"))),r&&(s.subscription=r.substring(0,r.lastIndexOf(\"-pnpres\"))),s.action=e.payload.action,s.state=e.payload.data,s.timetoken=i.publishTimetoken,s.occupancy=e.payload.occupancy,s.uuid=e.payload.uuid,s.timestamp=e.payload.timestamp,e.payload.join&&(s.join=e.payload.join),e.payload.leave&&(s.leave=e.payload.leave),e.payload.timeout&&(s.timeout=e.payload.timeout),n._listenerManager.announcePresence(s)}else{var a={channel:null,subscription:null};a.actualChannel=null!=r?t:null,a.subscribedChannel=null!=r?r:t,a.channel=t,a.subscription=r,a.timetoken=i.publishTimetoken,a.publisher=e.issuingClientId,e.userMetadata&&(a.userMetadata=e.userMetadata),n._config.cipherKey?a.message=n._crypto.decrypt(e.payload):a.message=e.payload,n._listenerManager.announceMessage(a)}}),this._region=t.metadata.region,this._startSubscribeLoop()}}},{key:\"_stopSubscribeLoop\",value:function(){this._subscribeCall&&(\"function\"==typeof this._subscribeCall.abort&&this._subscribeCall.abort(),this._subscribeCall=null)}}]),e}();t.default=c,e.exports=t.default},function(e,t,n){\"use strict\";Object.defineProperty(t,\"__esModule\",{value:!0});var r,i=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,\"value\"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),s=(n(5),n(10)),o=(r=s)&&r.__esModule?r:{default:r};var a=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError(\"Cannot call a class as a function\")}(this,e),this._listeners=[]}return i(e,[{key:\"addListener\",value:function(e){this._listeners.push(e)}},{key:\"removeListener\",value:function(e){var t=[];this._listeners.forEach(function(n){n!==e&&t.push(n)}),this._listeners=t}},{key:\"removeAllListeners\",value:function(){this._listeners=[]}},{key:\"announcePresence\",value:function(e){this._listeners.forEach(function(t){t.presence&&t.presence(e)})}},{key:\"announceStatus\",value:function(e){this._listeners.forEach(function(t){t.status&&t.status(e)})}},{key:\"announceMessage\",value:function(e){this._listeners.forEach(function(t){t.message&&t.message(e)})}},{key:\"announceNetworkUp\",value:function(){var e={};e.category=o.default.PNNetworkUpCategory,this.announceStatus(e)}},{key:\"announceNetworkDown\",value:function(){var e={};e.category=o.default.PNNetworkDownCategory,this.announceStatus(e)}}]),e}();t.default=a,e.exports=t.default},function(e,t){\"use strict\";Object.defineProperty(t,\"__esModule\",{value:!0}),t.default={PNNetworkUpCategory:\"PNNetworkUpCategory\",PNNetworkDownCategory:\"PNNetworkDownCategory\",PNNetworkIssuesCategory:\"PNNetworkIssuesCategory\",PNTimeoutCategory:\"PNTimeoutCategory\",PNBadRequestCategory:\"PNBadRequestCategory\",PNAccessDeniedCategory:\"PNAccessDeniedCategory\",PNUnknownCategory:\"PNUnknownCategory\",PNReconnectedCategory:\"PNReconnectedCategory\",PNConnectedCategory:\"PNConnectedCategory\",PNRequestMessageCountExceededCategory:\"PNRequestMessageCountExceededCategory\"},e.exports=t.default},function(e,t,n){\"use strict\";Object.defineProperty(t,\"__esModule\",{value:!0});var r,i=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,\"value\"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),s=n(12);(r=s)&&r.__esModule,n(5);var o=function(){function e(t){var n=t.timeEndpoint;!function(e,t){if(!(e instanceof t))throw new TypeError(\"Cannot call a class as a function\")}(this,e),this._timeEndpoint=n}return i(e,[{key:\"onReconnection\",value:function(e){this._reconnectionCallback=e}},{key:\"startPolling\",value:function(){this._timeTimer=setInterval(this._performTimeLoop.bind(this),3e3)}},{key:\"stopPolling\",value:function(){clearInterval(this._timeTimer)}},{key:\"_performTimeLoop\",value:function(){var e=this;this._timeEndpoint(function(t){t.error||(clearInterval(e._timeTimer),e._reconnectionCallback())})}}]),e}();t.default=o,e.exports=t.default},function(e,t,n){\"use strict\";Object.defineProperty(t,\"__esModule\",{value:!0}),t.getOperation=function(){return s.default.PNTimeOperation},t.getURL=function(){return\"/time/0\"},t.getRequestTimeout=function(e){return e.config.getTransactionTimeout()},t.prepareParams=function(){return{}},t.isAuthSupported=function(){return!1},t.handleResponse=function(e,t){return{timetoken:t[0]}},t.validateParams=function(){};n(5);var r,i=n(13),s=(r=i)&&r.__esModule?r:{default:r}},function(e,t){\"use strict\";Object.defineProperty(t,\"__esModule\",{value:!0}),t.default={PNTimeOperation:\"PNTimeOperation\",PNHistoryOperation:\"PNHistoryOperation\",PNDeleteMessagesOperation:\"PNDeleteMessagesOperation\",PNFetchMessagesOperation:\"PNFetchMessagesOperation\",PNSubscribeOperation:\"PNSubscribeOperation\",PNUnsubscribeOperation:\"PNUnsubscribeOperation\",PNPublishOperation:\"PNPublishOperation\",PNPushNotificationEnabledChannelsOperation:\"PNPushNotificationEnabledChannelsOperation\",PNRemoveAllPushNotificationsOperation:\"PNRemoveAllPushNotificationsOperation\",PNWhereNowOperation:\"PNWhereNowOperation\",PNSetStateOperation:\"PNSetStateOperation\",PNHereNowOperation:\"PNHereNowOperation\",PNGetStateOperation:\"PNGetStateOperation\",PNHeartbeatOperation:\"PNHeartbeatOperation\",PNChannelGroupsOperation:\"PNChannelGroupsOperation\",PNRemoveGroupOperation:\"PNRemoveGroupOperation\",PNChannelsForGroupOperation:\"PNChannelsForGroupOperation\",PNAddChannelsToGroupOperation:\"PNAddChannelsToGroupOperation\",PNRemoveChannelsFromGroupOperation:\"PNRemoveChannelsFromGroupOperation\",PNAccessManagerGrant:\"PNAccessManagerGrant\",PNAccessManagerAudit:\"PNAccessManagerAudit\"},e.exports=t.default},function(e,t,n){\"use strict\";Object.defineProperty(t,\"__esModule\",{value:!0});var r,i=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,\"value\"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),s=n(2);(r=s)&&r.__esModule,n(5);var o=function(){function e(t){var n=t.config;!function(e,t){if(!(e instanceof t))throw new TypeError(\"Cannot call a class as a function\")}(this,e),this.hashHistory=[],this._config=n}return i(e,[{key:\"getKey\",value:function(e){var t=function(e){var t=0;if(0===e.length)return t;for(var n=0;n<e.length;n+=1)t=(t<<5)-t+e.charCodeAt(n),t&=t;return t}(JSON.stringify(e.payload)).toString();return e.publishMetaData.publishTimetoken+\"-\"+t}},{key:\"isDuplicate\",value:function(e){return this.hashHistory.includes(this.getKey(e))}},{key:\"addEntry\",value:function(e){this.hashHistory.length>=this._config.maximumCacheSize&&this.hashHistory.shift(),this.hashHistory.push(this.getKey(e))}},{key:\"clearHistory\",value:function(){this.hashHistory=[]}}]),e}();t.default=o,e.exports=t.default},function(e,t){\"use strict\";function n(e){return encodeURIComponent(e).replace(/[!~*'()]/g,function(e){return\"%\"+e.charCodeAt(0).toString(16).toUpperCase()})}function r(e){return function(e){var t=[];return Object.keys(e).forEach(function(e){return t.push(e)}),t}(e).sort()}e.exports={signPamFromParams:function(e){return r(e).map(function(t){return t+\"=\"+n(e[t])}).join(\"&\")},endsWith:function(e,t){return-1!==e.indexOf(t,this.length-t.length)},createPromise:function(){var e=void 0,t=void 0;return{promise:new Promise(function(n,r){e=n,t=r}),reject:t,fulfill:e}},encodeString:n}},function(e,t,n){\"use strict\";Object.defineProperty(t,\"__esModule\",{value:!0}),t.default=function(e,t){var n=e.networking,o=e.config,c=null,l=null,d={};t.getOperation()===s.default.PNTimeOperation||t.getOperation()===s.default.PNChannelGroupsOperation?c=arguments.length<=2?void 0:arguments[2]:(d=arguments.length<=2?void 0:arguments[2],c=arguments.length<=3?void 0:arguments[3]),\"undefined\"==typeof Promise||c||(l=i.default.createPromise());var h=t.validateParams(e,d);if(h)return c?c(u(h)):l?(l.reject(new a(\"Validation failed, check status for details\",u(h))),l.promise):void 0;var p=t.prepareParams(e,d),f=function(e,t,n){return e.usePost&&e.usePost(t,n)?e.postURL(t,n):e.getURL(t,n)}(t,e,d),g=void 0,m={url:f,operation:t.getOperation(),timeout:t.getRequestTimeout(e)};p.uuid=o.UUID,p.pnsdk=function(e){if(e.sdkName)return e.sdkName;var t=\"PubNub-JS-\"+e.sdkFamily;e.partnerId&&(t+=\"-\"+e.partnerId);return t+=\"/\"+e.getVersion()}(o),o.useInstanceId&&(p.instanceid=o.instanceId),o.useRequestId&&(p.requestid=r.default.createUUID()),t.isAuthSupported()&&o.getAuthKey()&&(p.auth=o.getAuthKey()),o.secretKey&&function(e,t,n){var r=e.config,s=e.crypto;n.timestamp=Math.floor((new Date).getTime()/1e3);var o=r.subscribeKey+\"\\n\"+r.publishKey+\"\\n\"+t+\"\\n\";o+=i.default.signPamFromParams(n);var a=s.HMACSHA256(o);a=(a=a.replace(/\\+/g,\"-\")).replace(/\\//g,\"_\"),n.signature=a}(e,f,p);var y=function(n,r){if(n.error)c?c(n):l&&l.reject(new a(\"PubNub call failed, check status for details\",n));else{var i=t.handleResponse(e,r,d);c?c(n,i):l&&l.fulfill(i)}};if(t.usePost&&t.usePost(e,d)){var v=t.postPayload(e,d);g=n.POST(p,v,m,y)}else g=t.useDelete&&t.useDelete()?n.DELETE(p,m,y):n.GET(p,m,y);return t.getOperation()===s.default.PNSubscribeOperation?g:l?l.promise:void 0};var r=o(n(3)),i=(n(5),o(n(15))),s=(o(n(2)),o(n(13)));function o(e){return e&&e.__esModule?e:{default:e}}var a=function(e){function t(e,n){!function(e,t){if(!(e instanceof t))throw new TypeError(\"Cannot call a class as a function\")}(this,t);var r=function(e,t){if(!e)throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\");return!t||\"object\"!=typeof t&&\"function\"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return r.name=r.constructor.name,r.status=n,r.message=e,r}return function(e,t){if(\"function\"!=typeof t&&null!==t)throw new TypeError(\"Super expression must either be null or a function, not \"+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,Error),t}();function u(e){return(t={message:e}).type=\"validationError\",t.error=!0,t;var t}e.exports=t.default},function(e,t,n){\"use strict\";Object.defineProperty(t,\"__esModule\",{value:!0}),t.getOperation=function(){return r.default.PNAddChannelsToGroupOperation},t.validateParams=function(e,t){var n=t.channels,r=t.channelGroup,i=e.config;if(!r)return\"Missing Channel Group\";if(!n||0===n.length)return\"Missing Channels\";if(!i.subscribeKey)return\"Missing Subscribe Key\"},t.getURL=function(e,t){var n=t.channelGroup;return\"/v1/channel-registration/sub-key/\"+e.config.subscribeKey+\"/channel-group/\"+i.default.encodeString(n)},t.getRequestTimeout=function(e){return e.config.getTransactionTimeout()},t.isAuthSupported=function(){return!0},t.prepareParams=function(e,t){var n=t.channels;return{add:(void 0===n?[]:n).join(\",\")}},t.handleResponse=function(){return{}};n(5);var r=s(n(13)),i=s(n(15));function s(e){return e&&e.__esModule?e:{default:e}}},function(e,t,n){\"use strict\";Object.defineProperty(t,\"__esModule\",{value:!0}),t.getOperation=function(){return r.default.PNRemoveChannelsFromGroupOperation},t.validateParams=function(e,t){var n=t.channels,r=t.channelGroup,i=e.config;if(!r)return\"Missing Channel Group\";if(!n||0===n.length)return\"Missing Channels\";if(!i.subscribeKey)return\"Missing Subscribe Key\"},t.getURL=function(e,t){var n=t.channelGroup;return\"/v1/channel-registration/sub-key/\"+e.config.subscribeKey+\"/channel-group/\"+i.default.encodeString(n)},t.getRequestTimeout=function(e){return e.config.getTransactionTimeout()},t.isAuthSupported=function(){return!0},t.prepareParams=function(e,t){var n=t.channels;return{remove:(void 0===n?[]:n).join(\",\")}},t.handleResponse=function(){return{}};n(5);var r=s(n(13)),i=s(n(15));function s(e){return e&&e.__esModule?e:{default:e}}},function(e,t,n){\"use strict\";Object.defineProperty(t,\"__esModule\",{value:!0}),t.getOperation=function(){return r.default.PNRemoveGroupOperation},t.validateParams=function(e,t){var n=t.channelGroup,r=e.config;if(!n)return\"Missing Channel Group\";if(!r.subscribeKey)return\"Missing Subscribe Key\"},t.getURL=function(e,t){var n=t.channelGroup;return\"/v1/channel-registration/sub-key/\"+e.config.subscribeKey+\"/channel-group/\"+i.default.encodeString(n)+\"/remove\"},t.isAuthSupported=function(){return!0},t.getRequestTimeout=function(e){return e.config.getTransactionTimeout()},t.prepareParams=function(){return{}},t.handleResponse=function(){return{}};n(5);var r=s(n(13)),i=s(n(15));function s(e){return e&&e.__esModule?e:{default:e}}},function(e,t,n){\"use strict\";Object.defineProperty(t,\"__esModule\",{value:!0}),t.getOperation=function(){return s.default.PNChannelGroupsOperation},t.validateParams=function(e){if(!e.config.subscribeKey)return\"Missing Subscribe Key\"},t.getURL=function(e){return\"/v1/channel-registration/sub-key/\"+e.config.subscribeKey+\"/channel-group\"},t.getRequestTimeout=function(e){return e.config.getTransactionTimeout()},t.isAuthSupported=function(){return!0},t.prepareParams=function(){return{}},t.handleResponse=function(e,t){return{groups:t.payload.groups}};n(5);var r,i=n(13),s=(r=i)&&r.__esModule?r:{default:r}},function(e,t,n){\"use strict\";Object.defineProperty(t,\"__esModule\",{value:!0}),t.getOperation=function(){return r.default.PNChannelsForGroupOperation},t.validateParams=function(e,t){var n=t.channelGroup,r=e.config;if(!n)return\"Missing Channel Group\";if(!r.subscribeKey)return\"Missing Subscribe Key\"},t.getURL=function(e,t){var n=t.channelGroup;return\"/v1/channel-registration/sub-key/\"+e.config.subscribeKey+\"/channel-group/\"+i.default.encodeString(n)},t.getRequestTimeout=function(e){return e.config.getTransactionTimeout()},t.isAuthSupported=function(){return!0},t.prepareParams=function(){return{}},t.handleResponse=function(e,t){return{channels:t.payload.channels}};n(5);var r=s(n(13)),i=s(n(15));function s(e){return e&&e.__esModule?e:{default:e}}},function(e,t,n){\"use strict\";Object.defineProperty(t,\"__esModule\",{value:!0}),t.getOperation=function(){return s.default.PNPushNotificationEnabledChannelsOperation},t.validateParams=function(e,t){var n=t.device,r=t.pushGateway,i=t.channels,s=e.config;if(!n)return\"Missing Device ID (device)\";if(!r)return\"Missing GW Type (pushGateway: gcm or apns)\";if(!i||0===i.length)return\"Missing Channels\";if(!s.subscribeKey)return\"Missing Subscribe Key\"},t.getURL=function(e,t){var n=t.device;return\"/v1/push/sub-key/\"+e.config.subscribeKey+\"/devices/\"+n},t.getRequestTimeout=function(e){return e.config.getTransactionTimeout()},t.isAuthSupported=function(){return!0},t.prepareParams=function(e,t){var n=t.pushGateway,r=t.channels,i=void 0===r?[]:r;return{type:n,add:i.join(\",\")}},t.handleResponse=function(){return{}};n(5);var r,i=n(13),s=(r=i)&&r.__esModule?r:{default:r}},function(e,t,n){\"use strict\";Object.defineProperty(t,\"__esModule\",{value:!0}),t.getOperation=function(){return s.default.PNPushNotificationEnabledChannelsOperation},t.validateParams=function(e,t){var n=t.device,r=t.pushGateway,i=t.channels,s=e.config;if(!n)return\"Missing Device ID (device)\";if(!r)return\"Missing GW Type (pushGateway: gcm or apns)\";if(!i||0===i.length)return\"Missing Channels\";if(!s.subscribeKey)return\"Missing Subscribe Key\"},t.getURL=function(e,t){var n=t.device;return\"/v1/push/sub-key/\"+e.config.subscribeKey+\"/devices/\"+n},t.getRequestTimeout=function(e){return e.config.getTransactionTimeout()},t.isAuthSupported=function(){return!0},t.prepareParams=function(e,t){var n=t.pushGateway,r=t.channels,i=void 0===r?[]:r;return{type:n,remove:i.join(\",\")}},t.handleResponse=function(){return{}};n(5);var r,i=n(13),s=(r=i)&&r.__esModule?r:{default:r}},function(e,t,n){\"use strict\";Object.defineProperty(t,\"__esModule\",{value:!0}),t.getOperation=function(){return s.default.PNPushNotificationEnabledChannelsOperation},t.validateParams=function(e,t){var n=t.device,r=t.pushGateway,i=e.config;if(!n)return\"Missing Device ID (device)\";if(!r)return\"Missing GW Type (pushGateway: gcm or apns)\";if(!i.subscribeKey)return\"Missing Subscribe Key\"},t.getURL=function(e,t){var n=t.device;return\"/v1/push/sub-key/\"+e.config.subscribeKey+\"/devices/\"+n},t.getRequestTimeout=function(e){return e.config.getTransactionTimeout()},t.isAuthSupported=function(){return!0},t.prepareParams=function(e,t){return{type:t.pushGateway}},t.handleResponse=function(e,t){return{channels:t}};n(5);var r,i=n(13),s=(r=i)&&r.__esModule?r:{default:r}},function(e,t,n){\"use strict\";Object.defineProperty(t,\"__esModule\",{value:!0}),t.getOperation=function(){return s.default.PNRemoveAllPushNotificationsOperation},t.validateParams=function(e,t){var n=t.device,r=t.pushGateway,i=e.config;if(!n)return\"Missing Device ID (device)\";if(!r)return\"Missing GW Type (pushGateway: gcm or apns)\";if(!i.subscribeKey)return\"Missing Subscribe Key\"},t.getURL=function(e,t){var n=t.device;return\"/v1/push/sub-key/\"+e.config.subscribeKey+\"/devices/\"+n+\"/remove\"},t.getRequestTimeout=function(e){return e.config.getTransactionTimeout()},t.isAuthSupported=function(){return!0},t.prepareParams=function(e,t){return{type:t.pushGateway}},t.handleResponse=function(){return{}};n(5);var r,i=n(13),s=(r=i)&&r.__esModule?r:{default:r}},function(e,t,n){\"use strict\";Object.defineProperty(t,\"__esModule\",{value:!0}),t.getOperation=function(){return r.default.PNUnsubscribeOperation},t.validateParams=function(e){if(!e.config.subscribeKey)return\"Missing Subscribe Key\"},t.getURL=function(e,t){var n=e.config,r=t.channels,s=void 0===r?[]:r,o=s.length>0?s.join(\",\"):\",\";return\"/v2/presence/sub-key/\"+n.subscribeKey+\"/channel/\"+i.default.encodeString(o)+\"/leave\"},t.getRequestTimeout=function(e){return e.config.getTransactionTimeout()},t.isAuthSupported=function(){return!0},t.prepareParams=function(e,t){var n=t.channelGroups,r=void 0===n?[]:n,i={};r.length>0&&(i[\"channel-group\"]=r.join(\",\"));return i},t.handleResponse=function(){return{}};n(5);var r=s(n(13)),i=s(n(15));function s(e){return e&&e.__esModule?e:{default:e}}},function(e,t,n){\"use strict\";Object.defineProperty(t,\"__esModule\",{value:!0}),t.getOperation=function(){return s.default.PNWhereNowOperation},t.validateParams=function(e){if(!e.config.subscribeKey)return\"Missing Subscribe Key\"},t.getURL=function(e,t){var n=e.config,r=t.uuid,i=void 0===r?n.UUID:r;return\"/v2/presence/sub-key/\"+n.subscribeKey+\"/uuid/\"+i},t.getRequestTimeout=function(e){return e.config.getTransactionTimeout()},t.isAuthSupported=function(){return!0},t.prepareParams=function(){return{}},t.handleResponse=function(e,t){if(!t.payload)return{channels:[]};return{channels:t.payload.channels}};n(5);var r,i=n(13),s=(r=i)&&r.__esModule?r:{default:r}},function(e,t,n){\"use strict\";Object.defineProperty(t,\"__esModule\",{value:!0}),t.getOperation=function(){return r.default.PNHeartbeatOperation},t.validateParams=function(e){if(!e.config.subscribeKey)return\"Missing Subscribe Key\"},t.getURL=function(e,t){var n=e.config,r=t.channels,s=void 0===r?[]:r,o=s.length>0?s.join(\",\"):\",\";return\"/v2/presence/sub-key/\"+n.subscribeKey+\"/channel/\"+i.default.encodeString(o)+\"/heartbeat\"},t.isAuthSupported=function(){return!0},t.getRequestTimeout=function(e){return e.config.getTransactionTimeout()},t.prepareParams=function(e,t){var n=t.channelGroups,r=void 0===n?[]:n,i=t.state,s=void 0===i?{}:i,o=e.config,a={};r.length>0&&(a[\"channel-group\"]=r.join(\",\"));return a.state=JSON.stringify(s),a.heartbeat=o.getPresenceTimeout(),a},t.handleResponse=function(){return{}};n(5);var r=s(n(13)),i=s(n(15));function s(e){return e&&e.__esModule?e:{default:e}}},function(e,t,n){\"use strict\";Object.defineProperty(t,\"__esModule\",{value:!0}),t.getOperation=function(){return r.default.PNGetStateOperation},t.validateParams=function(e){if(!e.config.subscribeKey)return\"Missing Subscribe Key\"},t.getURL=function(e,t){var n=e.config,r=t.uuid,s=void 0===r?n.UUID:r,o=t.channels,a=void 0===o?[]:o,u=a.length>0?a.join(\",\"):\",\";return\"/v2/presence/sub-key/\"+n.subscribeKey+\"/channel/\"+i.default.encodeString(u)+\"/uuid/\"+s},t.getRequestTimeout=function(e){return e.config.getTransactionTimeout()},t.isAuthSupported=function(){return!0},t.prepareParams=function(e,t){var n=t.channelGroups,r=void 0===n?[]:n,i={};r.length>0&&(i[\"channel-group\"]=r.join(\",\"));return i},t.handleResponse=function(e,t,n){var r=n.channels,i=void 0===r?[]:r,s=n.channelGroups,o=void 0===s?[]:s,a={};1===i.length&&0===o.length?a[i[0]]=t.payload:a=t.payload;return{channels:a}};n(5);var r=s(n(13)),i=s(n(15));function s(e){return e&&e.__esModule?e:{default:e}}},function(e,t,n){\"use strict\";Object.defineProperty(t,\"__esModule\",{value:!0}),t.getOperation=function(){return r.default.PNSetStateOperation},t.validateParams=function(e,t){var n=e.config,r=t.state,i=t.channels,s=void 0===i?[]:i,o=t.channelGroups,a=void 0===o?[]:o;if(!r)return\"Missing State\";if(!n.subscribeKey)return\"Missing Subscribe Key\";if(0===s.length&&0===a.length)return\"Please provide a list of channels and/or channel-groups\"},t.getURL=function(e,t){var n=e.config,r=t.channels,s=void 0===r?[]:r,o=s.length>0?s.join(\",\"):\",\";return\"/v2/presence/sub-key/\"+n.subscribeKey+\"/channel/\"+i.default.encodeString(o)+\"/uuid/\"+n.UUID+\"/data\"},t.getRequestTimeout=function(e){return e.config.getTransactionTimeout()},t.isAuthSupported=function(){return!0},t.prepareParams=function(e,t){var n=t.state,r=t.channelGroups,i=void 0===r?[]:r,s={};s.state=JSON.stringify(n),i.length>0&&(s[\"channel-group\"]=i.join(\",\"));return s},t.handleResponse=function(e,t){return{state:t.payload}};n(5);var r=s(n(13)),i=s(n(15));function s(e){return e&&e.__esModule?e:{default:e}}},function(e,t,n){\"use strict\";Object.defineProperty(t,\"__esModule\",{value:!0}),t.getOperation=function(){return r.default.PNHereNowOperation},t.validateParams=function(e){if(!e.config.subscribeKey)return\"Missing Subscribe Key\"},t.getURL=function(e,t){var n=e.config,r=t.channels,s=void 0===r?[]:r,o=t.channelGroups,a=void 0===o?[]:o,u=\"/v2/presence/sub-key/\"+n.subscribeKey;if(s.length>0||a.length>0){var c=s.length>0?s.join(\",\"):\",\";u+=\"/channel/\"+i.default.encodeString(c)}return u},t.getRequestTimeout=function(e){return e.config.getTransactionTimeout()},t.isAuthSupported=function(){return!0},t.prepareParams=function(e,t){var n=t.channelGroups,r=void 0===n?[]:n,i=t.includeUUIDs,s=void 0===i||i,o=t.includeState,a=void 0!==o&&o,u={};s||(u.disable_uuids=1);a&&(u.state=1);r.length>0&&(u[\"channel-group\"]=r.join(\",\"));return u},t.handleResponse=function(e,t,n){var r=n.channels,i=void 0===r?[]:r,s=n.channelGroups,o=void 0===s?[]:s,a=n.includeUUIDs,u=void 0===a||a,c=n.includeState,l=void 0!==c&&c,d=void 0;d=i.length>1||o.length>0||0===o.length&&0===i.length?function(){var e={};return e.totalChannels=t.payload.total_channels,e.totalOccupancy=t.payload.total_occupancy,e.channels={},Object.keys(t.payload.channels).forEach(function(n){var r=t.payload.channels[n],i=[];return e.channels[n]={occupants:i,name:n,occupancy:r.occupancy},u&&r.uuids.forEach(function(e){l?i.push({state:e.state,uuid:e.uuid}):i.push({state:null,uuid:e})}),e}),e}():function(){var e={},n=[];e.totalChannels=1,e.totalOccupancy=t.occupancy,e.channels={},e.channels[i[0]]={occupants:n,name:i[0],occupancy:t.occupancy},u&&t.uuids&&t.uuids.forEach(function(e){l?n.push({state:e.state,uuid:e.uuid}):n.push({state:null,uuid:e})});return e}();return d};n(5);var r=s(n(13)),i=s(n(15));function s(e){return e&&e.__esModule?e:{default:e}}},function(e,t,n){\"use strict\";Object.defineProperty(t,\"__esModule\",{value:!0}),t.getOperation=function(){return s.default.PNAccessManagerAudit},t.validateParams=function(e){if(!e.config.subscribeKey)return\"Missing Subscribe Key\"},t.getURL=function(e){return\"/v2/auth/audit/sub-key/\"+e.config.subscribeKey},t.getRequestTimeout=function(e){return e.config.getTransactionTimeout()},t.isAuthSupported=function(){return!1},t.prepareParams=function(e,t){var n=t.channel,r=t.channelGroup,i=t.authKeys,s=void 0===i?[]:i,o={};n&&(o.channel=n);r&&(o[\"channel-group\"]=r);s.length>0&&(o.auth=s.join(\",\"));return o},t.handleResponse=function(e,t){return t.payload};n(5);var r,i=n(13),s=(r=i)&&r.__esModule?r:{default:r}},function(e,t,n){\"use strict\";Object.defineProperty(t,\"__esModule\",{value:!0}),t.getOperation=function(){return s.default.PNAccessManagerGrant},t.validateParams=function(e){var t=e.config;if(!t.subscribeKey)return\"Missing Subscribe Key\";if(!t.publishKey)return\"Missing Publish Key\";if(!t.secretKey)return\"Missing Secret Key\"},t.getURL=function(e){return\"/v2/auth/grant/sub-key/\"+e.config.subscribeKey},t.getRequestTimeout=function(e){return e.config.getTransactionTimeout()},t.isAuthSupported=function(){return!1},t.prepareParams=function(e,t){var n=t.channels,r=void 0===n?[]:n,i=t.channelGroups,s=void 0===i?[]:i,o=t.ttl,a=t.read,u=void 0!==a&&a,c=t.write,l=void 0!==c&&c,d=t.manage,h=void 0!==d&&d,p=t.authKeys,f=void 0===p?[]:p,g={};g.r=u?\"1\":\"0\",g.w=l?\"1\":\"0\",g.m=h?\"1\":\"0\",r.length>0&&(g.channel=r.join(\",\"));s.length>0&&(g[\"channel-group\"]=s.join(\",\"));f.length>0&&(g.auth=f.join(\",\"));(o||0===o)&&(g.ttl=o);return g},t.handleResponse=function(){return{}};n(5);var r,i=n(13),s=(r=i)&&r.__esModule?r:{default:r}},function(e,t,n){\"use strict\";Object.defineProperty(t,\"__esModule\",{value:!0});var r=\"function\"==typeof Symbol&&\"symbol\"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&\"function\"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?\"symbol\":typeof e};t.getOperation=function(){return i.default.PNPublishOperation},t.validateParams=function(e,t){var n=e.config,r=t.message;if(!t.channel)return\"Missing Channel\";if(!r)return\"Missing Message\";if(!n.subscribeKey)return\"Missing Subscribe Key\"},t.usePost=function(e,t){var n=t.sendByPost;return void 0!==n&&n},t.getURL=function(e,t){var n=e.config,r=t.channel,i=t.message,o=a(e,i);return\"/publish/\"+n.publishKey+\"/\"+n.subscribeKey+\"/0/\"+s.default.encodeString(r)+\"/0/\"+s.default.encodeString(o)},t.postURL=function(e,t){var n=e.config,r=t.channel;return\"/publish/\"+n.publishKey+\"/\"+n.subscribeKey+\"/0/\"+s.default.encodeString(r)+\"/0\"},t.getRequestTimeout=function(e){return e.config.getTransactionTimeout()},t.isAuthSupported=function(){return!0},t.postPayload=function(e,t){var n=t.message;return a(e,n)},t.prepareParams=function(e,t){var n=t.meta,i=t.replicate,s=void 0===i||i,o=t.storeInHistory,a=t.ttl,u={};null!=o&&(u.store=o?\"1\":\"0\");a&&(u.ttl=a);!1===s&&(u.norep=\"true\");n&&\"object\"===(void 0===n?\"undefined\":r(n))&&(u.meta=JSON.stringify(n));return u},t.handleResponse=function(e,t){return{timetoken:t[2]}};n(5);var i=o(n(13)),s=o(n(15));function o(e){return e&&e.__esModule?e:{default:e}}function a(e,t){var n=e.crypto,r=e.config,i=JSON.stringify(t);return r.cipherKey&&(i=n.encrypt(i),i=JSON.stringify(i)),i}},function(e,t,n){\"use strict\";Object.defineProperty(t,\"__esModule\",{value:!0}),t.getOperation=function(){return r.default.PNHistoryOperation},t.validateParams=function(e,t){var n=t.channel,r=e.config;if(!n)return\"Missing channel\";if(!r.subscribeKey)return\"Missing Subscribe Key\"},t.getURL=function(e,t){var n=t.channel;return\"/v2/history/sub-key/\"+e.config.subscribeKey+\"/channel/\"+i.default.encodeString(n)},t.getRequestTimeout=function(e){return e.config.getTransactionTimeout()},t.isAuthSupported=function(){return!0},t.prepareParams=function(e,t){var n=t.start,r=t.end,i=t.reverse,s=t.count,o=void 0===s?100:s,a=t.stringifiedTimeToken,u=void 0!==a&&a,c={include_token:\"true\"};c.count=o,n&&(c.start=n);r&&(c.end=r);u&&(c.string_message_token=\"true\");null!=i&&(c.reverse=i.toString());return c},t.handleResponse=function(e,t){var n={messages:[],startTimeToken:t[1],endTimeToken:t[2]};return t[0].forEach(function(t){var r={timetoken:t.timetoken,entry:o(e,t.message)};n.messages.push(r)}),n};n(5);var r=s(n(13)),i=s(n(15));function s(e){return e&&e.__esModule?e:{default:e}}function o(e,t){var n=e.config,r=e.crypto;if(!n.cipherKey)return t;try{return r.decrypt(t)}catch(e){return t}}},function(e,t,n){\"use strict\";Object.defineProperty(t,\"__esModule\",{value:!0}),t.getOperation=function(){return r.default.PNDeleteMessagesOperation},t.validateParams=function(e,t){var n=t.channel,r=e.config;if(!n)return\"Missing channel\";if(!r.subscribeKey)return\"Missing Subscribe Key\"},t.useDelete=function(){return!0},t.getURL=function(e,t){var n=t.channel;return\"/v3/history/sub-key/\"+e.config.subscribeKey+\"/channel/\"+i.default.encodeString(n)},t.getRequestTimeout=function(e){return e.config.getTransactionTimeout()},t.isAuthSupported=function(){return!0},t.prepareParams=function(e,t){var n=t.start,r=t.end,i={};n&&(i.start=n);r&&(i.end=r);return i},t.handleResponse=function(e,t){return t.payload};n(5);var r=s(n(13)),i=s(n(15));function s(e){return e&&e.__esModule?e:{default:e}}},function(e,t,n){\"use strict\";Object.defineProperty(t,\"__esModule\",{value:!0}),t.getOperation=function(){return r.default.PNFetchMessagesOperation},t.validateParams=function(e,t){var n=t.channels,r=e.config;if(!n||0===n.length)return\"Missing channels\";if(!r.subscribeKey)return\"Missing Subscribe Key\"},t.getURL=function(e,t){var n=t.channels,r=void 0===n?[]:n,s=e.config,o=r.length>0?r.join(\",\"):\",\";return\"/v3/history/sub-key/\"+s.subscribeKey+\"/channel/\"+i.default.encodeString(o)},t.getRequestTimeout=function(e){return e.config.getTransactionTimeout()},t.isAuthSupported=function(){return!0},t.prepareParams=function(e,t){var n=t.start,r=t.end,i=t.count,s={};i&&(s.max=i);n&&(s.start=n);r&&(s.end=r);return s},t.handleResponse=function(e,t){var n={channels:{}};return Object.keys(t.channels||{}).forEach(function(r){n.channels[r]=[],(t.channels[r]||[]).forEach(function(t){var i={};i.channel=r,i.subscription=null,i.timetoken=t.timetoken,i.message=function(e,t){var n=e.config,r=e.crypto;if(!n.cipherKey)return t;try{return r.decrypt(t)}catch(e){return t}}(e,t.message),n.channels[r].push(i)})}),n};n(5);var r=s(n(13)),i=s(n(15));function s(e){return e&&e.__esModule?e:{default:e}}},function(e,t,n){\"use strict\";Object.defineProperty(t,\"__esModule\",{value:!0}),t.getOperation=function(){return r.default.PNSubscribeOperation},t.validateParams=function(e){if(!e.config.subscribeKey)return\"Missing Subscribe Key\"},t.getURL=function(e,t){var n=e.config,r=t.channels,s=void 0===r?[]:r,o=s.length>0?s.join(\",\"):\",\";return\"/v2/subscribe/\"+n.subscribeKey+\"/\"+i.default.encodeString(o)+\"/0\"},t.getRequestTimeout=function(e){return e.config.getSubscribeTimeout()},t.isAuthSupported=function(){return!0},t.prepareParams=function(e,t){var n=e.config,r=t.channelGroups,i=void 0===r?[]:r,s=t.timetoken,o=t.filterExpression,a=t.region,u={heartbeat:n.getPresenceTimeout()};i.length>0&&(u[\"channel-group\"]=i.join(\",\"));o&&o.length>0&&(u[\"filter-expr\"]=o);s&&(u.tt=s);a&&(u.tr=a);return u},t.handleResponse=function(e,t){var n=[];t.m.forEach(function(e){var t={publishTimetoken:e.p.t,region:e.p.r},r={shard:parseInt(e.a,10),subscriptionMatch:e.b,channel:e.c,payload:e.d,flags:e.f,issuingClientId:e.i,subscribeKey:e.k,originationTimetoken:e.o,userMetadata:e.u,publishMetaData:t};n.push(r)});var r={timetoken:t.t.t,region:t.t.r};return{messages:n,metadata:r}};n(5);var r=s(n(13)),i=s(n(15));function s(e){return e&&e.__esModule?e:{default:e}}},function(e,t,n){\"use strict\";Object.defineProperty(t,\"__esModule\",{value:!0});var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,\"value\"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=(s(n(2)),s(n(10)));n(5);function s(e){return e&&e.__esModule?e:{default:e}}var o=function(){function e(t){var n=this;!function(e,t){if(!(e instanceof t))throw new TypeError(\"Cannot call a class as a function\")}(this,e),this._modules={},Object.keys(t).forEach(function(e){n._modules[e]=t[e].bind(n)})}return r(e,[{key:\"init\",value:function(e){this._config=e,this._maxSubDomain=20,this._currentSubDomain=Math.floor(Math.random()*this._maxSubDomain),this._providedFQDN=(this._config.secure?\"https://\":\"http://\")+this._config.origin,this._coreParams={},this.shiftStandardOrigin()}},{key:\"nextOrigin\",value:function(){if(-1===this._providedFQDN.indexOf(\"pubsub.\"))return this._providedFQDN;var e;return this._currentSubDomain=this._currentSubDomain+1,this._currentSubDomain>=this._maxSubDomain&&(this._currentSubDomain=1),e=this._currentSubDomain.toString(),this._providedFQDN.replace(\"pubsub\",\"ps\"+e)}},{key:\"hasModule\",value:function(e){return e in this._modules}},{key:\"shiftStandardOrigin\",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return this._standardOrigin=this.nextOrigin(e),this._standardOrigin}},{key:\"getStandardOrigin\",value:function(){return this._standardOrigin}},{key:\"POST\",value:function(e,t,n,r){return this._modules.post(e,t,n,r)}},{key:\"GET\",value:function(e,t,n){return this._modules.get(e,t,n)}},{key:\"DELETE\",value:function(e,t,n){return this._modules.del(e,t,n)}},{key:\"_detectErrorCategory\",value:function(e){if(\"ENOTFOUND\"===e.code)return i.default.PNNetworkIssuesCategory;if(\"ECONNREFUSED\"===e.code)return i.default.PNNetworkIssuesCategory;if(\"ECONNRESET\"===e.code)return i.default.PNNetworkIssuesCategory;if(\"EAI_AGAIN\"===e.code)return i.default.PNNetworkIssuesCategory;if(0===e.status||e.hasOwnProperty(\"status\")&&void 0===e.status)return i.default.PNNetworkIssuesCategory;if(e.timeout)return i.default.PNTimeoutCategory;if(\"ETIMEDOUT\"===e.code)return i.default.PNNetworkIssuesCategory;if(e.response){if(e.response.badRequest)return i.default.PNBadRequestCategory;if(e.response.forbidden)return i.default.PNAccessDeniedCategory}return i.default.PNUnknownCategory}}]),e}();t.default=o,e.exports=t.default},function(e,t){\"use strict\";Object.defineProperty(t,\"__esModule\",{value:!0}),t.default={get:function(e){try{return localStorage.getItem(e)}catch(e){return null}},set:function(e,t){try{return localStorage.setItem(e,t)}catch(e){return null}}},e.exports=t.default},function(e,t,n){\"use strict\";Object.defineProperty(t,\"__esModule\",{value:!0}),t.get=function(e,t,n){var r=s.default.get(this.getStandardOrigin()+t.url).query(e);return a.call(this,r,t,n)},t.post=function(e,t,n,r){var i=s.default.post(this.getStandardOrigin()+n.url).query(e).send(t);return a.call(this,i,n,r)},t.del=function(e,t,n){var r=s.default.delete(this.getStandardOrigin()+t.url).query(e);return a.call(this,r,t,n)};var r,i=n(42),s=(r=i)&&r.__esModule?r:{default:r};n(5);function o(e){var t=(new Date).getTime(),n=(new Date).toISOString(),r=console&&console.log?console:window&&window.console&&window.console.log?window.console:console;r.log(\"<<<<<\"),r.log(\"[\"+n+\"]\",\"\\n\",e.url,\"\\n\",e.qs),r.log(\"-----\"),e.on(\"response\",function(n){var i=(new Date).getTime()-t,s=(new Date).toISOString();r.log(\">>>>>>\"),r.log(\"[\"+s+\" / \"+i+\"]\",\"\\n\",e.url,\"\\n\",e.qs,\"\\n\",n.text),r.log(\"-----\")})}function a(e,t,n){var r=this;return this._config.logVerbosity&&(e=e.use(o)),this._config.proxy&&this._modules.proxy&&(e=this._modules.proxy.call(this,e)),this._config.keepAlive&&this._modules.keepAlive&&(e=this._modules.keepAlive(e)),e.timeout(t.timeout).end(function(e,i){var s={};if(s.error=null!==e,s.operation=t.operation,i&&i.status&&(s.statusCode=i.status),e)return s.errorData=e,s.category=r._detectErrorCategory(e),n(s,null);var o=JSON.parse(i.text);return o.error&&1===o.error&&o.status&&o.message&&o.service?(s.errorData=o,s.statusCode=o.status,s.error=!0,s.category=r._detectErrorCategory(s),n(s,null)):n(s,o)})}},function(e,t,n){var r;\"undefined\"!=typeof window?r=window:\"undefined\"!=typeof self?r=self:(console.warn(\"Using browser-only version of superagent in non-browser environment\"),r=this);var i=n(43),s=n(44),o=n(45),a=n(46),u=n(48);function c(){}var l=t=e.exports=function(e,n){return\"function\"==typeof n?new t.Request(\"GET\",e).end(n):1==arguments.length?new t.Request(\"GET\",e):new t.Request(e,n)};t.Request=y,l.getXHR=function(){if(!(!r.XMLHttpRequest||r.location&&\"file:\"==r.location.protocol&&r.ActiveXObject))return new XMLHttpRequest;try{return new ActiveXObject(\"Microsoft.XMLHTTP\")}catch(e){}try{return new ActiveXObject(\"Msxml2.XMLHTTP.6.0\")}catch(e){}try{return new ActiveXObject(\"Msxml2.XMLHTTP.3.0\")}catch(e){}try{return new ActiveXObject(\"Msxml2.XMLHTTP\")}catch(e){}throw Error(\"Browser-only version of superagent could not find XHR\")};var d=\"\".trim?function(e){return e.trim()}:function(e){return e.replace(/(^\\s*|\\s*$)/g,\"\")};function h(e){if(!o(e))return e;var t=[];for(var n in e)p(t,n,e[n]);return t.join(\"&\")}function p(e,t,n){if(null!=n)if(Array.isArray(n))n.forEach(function(n){p(e,t,n)});else if(o(n))for(var r in n)p(e,t+\"[\"+r+\"]\",n[r]);else e.push(encodeURIComponent(t)+\"=\"+encodeURIComponent(n));else null===n&&e.push(encodeURIComponent(t))}function f(e){for(var t,n,r={},i=e.split(\"&\"),s=0,o=i.length;s<o;++s)-1==(n=(t=i[s]).indexOf(\"=\"))?r[decodeURIComponent(t)]=\"\":r[decodeURIComponent(t.slice(0,n))]=decodeURIComponent(t.slice(n+1));return r}function g(e){return/[\\/+]json($|[^-\\w])/.test(e)}function m(e){this.req=e,this.xhr=this.req.xhr,this.text=\"HEAD\"!=this.req.method&&(\"\"===this.xhr.responseType||\"text\"===this.xhr.responseType)||void 0===this.xhr.responseType?this.xhr.responseText:null,this.statusText=this.req.xhr.statusText;var t=this.xhr.status;1223===t&&(t=204),this._setStatusProperties(t),this.header=this.headers=function(e){for(var t,n,r,i,s=e.split(/\\r?\\n/),o={},a=0,u=s.length;a<u;++a)-1!==(t=(n=s[a]).indexOf(\":\"))&&(r=n.slice(0,t).toLowerCase(),i=d(n.slice(t+1)),o[r]=i);return o}(this.xhr.getAllResponseHeaders()),this.header[\"content-type\"]=this.xhr.getResponseHeader(\"content-type\"),this._setHeaderProperties(this.header),null===this.text&&e._responseType?this.body=this.xhr.response:this.body=\"HEAD\"!=this.req.method?this._parseBody(this.text?this.text:this.xhr.response):null}function y(e,t){var n=this;this._query=this._query||[],this.method=e,this.url=t,this.header={},this._header={},this.on(\"end\",function(){var e,t=null,r=null;try{r=new m(n)}catch(e){return(t=new Error(\"Parser is unable to parse the response\")).parse=!0,t.original=e,n.xhr?(t.rawResponse=void 0===n.xhr.responseType?n.xhr.responseText:n.xhr.response,t.status=n.xhr.status?n.xhr.status:null,t.statusCode=t.status):(t.rawResponse=null,t.status=null),n.callback(t)}n.emit(\"response\",r);try{n._isResponseOK(r)||(e=new Error(r.statusText||\"Unsuccessful HTTP response\"))}catch(t){e=t}e?(e.original=t,e.response=r,e.status=r.status,n.callback(e,r)):n.callback(null,r)})}function v(e,t,n){var r=l(\"DELETE\",e);return\"function\"==typeof t&&(n=t,t=null),t&&r.send(t),n&&r.end(n),r}l.serializeObject=h,l.parseString=f,l.types={html:\"text/html\",json:\"application/json\",xml:\"text/xml\",urlencoded:\"application/x-www-form-urlencoded\",form:\"application/x-www-form-urlencoded\",\"form-data\":\"application/x-www-form-urlencoded\"},l.serialize={\"application/x-www-form-urlencoded\":h,\"application/json\":JSON.stringify},l.parse={\"application/x-www-form-urlencoded\":f,\"application/json\":JSON.parse},a(m.prototype),m.prototype._parseBody=function(e){var t=l.parse[this.type];return this.req._parser?this.req._parser(this,e):(!t&&g(this.type)&&(t=l.parse[\"application/json\"]),t&&e&&(e.length||e instanceof Object)?t(e):null)},m.prototype.toError=function(){var e=this.req,t=e.method,n=e.url,r=\"cannot \"+t+\" \"+n+\" (\"+this.status+\")\",i=new Error(r);return i.status=this.status,i.method=t,i.url=n,i},l.Response=m,i(y.prototype),s(y.prototype),y.prototype.type=function(e){return this.set(\"Content-Type\",l.types[e]||e),this},y.prototype.accept=function(e){return this.set(\"Accept\",l.types[e]||e),this},y.prototype.auth=function(e,t,n){1===arguments.length&&(t=\"\"),\"object\"==typeof t&&null!==t&&(n=t,t=\"\"),n||(n={type:\"function\"==typeof btoa?\"basic\":\"auto\"});return this._auth(e,t,n,function(e){if(\"function\"==typeof btoa)return btoa(e);throw new Error(\"Cannot use basic auth, btoa is not a function\")})},y.prototype.query=function(e){return\"string\"!=typeof e&&(e=h(e)),e&&this._query.push(e),this},y.prototype.attach=function(e,t,n){if(t){if(this._data)throw Error(\"superagent can't mix .send() and .attach()\");this._getFormData().append(e,t,n||t.name)}return this},y.prototype._getFormData=function(){return this._formData||(this._formData=new r.FormData),this._formData},y.prototype.callback=function(e,t){if(this._shouldRetry(e,t))return this._retry();var n=this._callback;this.clearTimeout(),e&&(this._maxRetries&&(e.retries=this._retries-1),this.emit(\"error\",e)),n(e,t)},y.prototype.crossDomainError=function(){var e=new Error(\"Request has been terminated\\nPossible causes: the network is offline, Origin is not allowed by Access-Control-Allow-Origin, the page is being unloaded, etc.\");e.crossDomain=!0,e.status=this.status,e.method=this.method,e.url=this.url,this.callback(e)},y.prototype.buffer=y.prototype.ca=y.prototype.agent=function(){return console.warn(\"This is not supported in browser version of superagent\"),this},y.prototype.pipe=y.prototype.write=function(){throw Error(\"Streaming is not supported in browser version of superagent\")},y.prototype._isHost=function(e){return e&&\"object\"==typeof e&&!Array.isArray(e)&&\"[object Object]\"!==Object.prototype.toString.call(e)},y.prototype.end=function(e){return this._endCalled&&console.warn(\"Warning: .end() was called twice. This is not supported in superagent\"),this._endCalled=!0,this._callback=e||c,this._finalizeQueryString(),this._end()},y.prototype._end=function(){var e=this,t=this.xhr=l.getXHR(),n=this._formData||this._data;this._setTimeouts(),t.onreadystatechange=function(){var n=t.readyState;if(n>=2&&e._responseTimeoutTimer&&clearTimeout(e._responseTimeoutTimer),4==n){var r;try{r=t.status}catch(e){r=0}if(!r){if(e.timedout||e._aborted)return;return e.crossDomainError()}e.emit(\"end\")}};var r=function(t,n){n.total>0&&(n.percent=n.loaded/n.total*100),n.direction=t,e.emit(\"progress\",n)};if(this.hasListeners(\"progress\"))try{t.onprogress=r.bind(null,\"download\"),t.upload&&(t.upload.onprogress=r.bind(null,\"upload\"))}catch(e){}try{this.username&&this.password?t.open(this.method,this.url,!0,this.username,this.password):t.open(this.method,this.url,!0)}catch(e){return this.callback(e)}if(this._withCredentials&&(t.withCredentials=!0),!this._formData&&\"GET\"!=this.method&&\"HEAD\"!=this.method&&\"string\"!=typeof n&&!this._isHost(n)){var i=this._header[\"content-type\"],s=this._serializer||l.serialize[i?i.split(\";\")[0]:\"\"];!s&&g(i)&&(s=l.serialize[\"application/json\"]),s&&(n=s(n))}for(var o in this.header)null!=this.header[o]&&this.header.hasOwnProperty(o)&&t.setRequestHeader(o,this.header[o]);return this._responseType&&(t.responseType=this._responseType),this.emit(\"request\",this),t.send(void 0!==n?n:null),this},l.agent=function(){return new u},[\"GET\",\"POST\",\"OPTIONS\",\"PATCH\",\"PUT\",\"DELETE\"].forEach(function(e){u.prototype[e.toLowerCase()]=function(t,n){var r=new l.Request(e,t);return this._setDefaults(r),n&&r.end(n),r}}),u.prototype.del=u.prototype.delete,l.get=function(e,t,n){var r=l(\"GET\",e);return\"function\"==typeof t&&(n=t,t=null),t&&r.query(t),n&&r.end(n),r},l.head=function(e,t,n){var r=l(\"HEAD\",e);return\"function\"==typeof t&&(n=t,t=null),t&&r.query(t),n&&r.end(n),r},l.options=function(e,t,n){var r=l(\"OPTIONS\",e);return\"function\"==typeof t&&(n=t,t=null),t&&r.send(t),n&&r.end(n),r},l.del=v,l.delete=v,l.patch=function(e,t,n){var r=l(\"PATCH\",e);return\"function\"==typeof t&&(n=t,t=null),t&&r.send(t),n&&r.end(n),r},l.post=function(e,t,n){var r=l(\"POST\",e);return\"function\"==typeof t&&(n=t,t=null),t&&r.send(t),n&&r.end(n),r},l.put=function(e,t,n){var r=l(\"PUT\",e);return\"function\"==typeof t&&(n=t,t=null),t&&r.send(t),n&&r.end(n),r}},function(e,t,n){function r(e){if(e)return function(e){for(var t in r.prototype)e[t]=r.prototype[t];return e}(e)}e.exports=r,r.prototype.on=r.prototype.addEventListener=function(e,t){return this._callbacks=this._callbacks||{},(this._callbacks[\"$\"+e]=this._callbacks[\"$\"+e]||[]).push(t),this},r.prototype.once=function(e,t){function n(){this.off(e,n),t.apply(this,arguments)}return n.fn=t,this.on(e,n),this},r.prototype.off=r.prototype.removeListener=r.prototype.removeAllListeners=r.prototype.removeEventListener=function(e,t){if(this._callbacks=this._callbacks||{},0==arguments.length)return this._callbacks={},this;var n,r=this._callbacks[\"$\"+e];if(!r)return this;if(1==arguments.length)return delete this._callbacks[\"$\"+e],this;for(var i=0;i<r.length;i++)if((n=r[i])===t||n.fn===t){r.splice(i,1);break}return this},r.prototype.emit=function(e){this._callbacks=this._callbacks||{};var t=[].slice.call(arguments,1),n=this._callbacks[\"$\"+e];if(n)for(var r=0,i=(n=n.slice(0)).length;r<i;++r)n[r].apply(this,t);return this},r.prototype.listeners=function(e){return this._callbacks=this._callbacks||{},this._callbacks[\"$\"+e]||[]},r.prototype.hasListeners=function(e){return!!this.listeners(e).length}},function(e,t,n){\"use strict\";var r=n(45);function i(e){if(e)return function(e){for(var t in i.prototype)e[t]=i.prototype[t];return e}(e)}e.exports=i,i.prototype.clearTimeout=function(){return clearTimeout(this._timer),clearTimeout(this._responseTimeoutTimer),delete this._timer,delete this._responseTimeoutTimer,this},i.prototype.parse=function(e){return this._parser=e,this},i.prototype.responseType=function(e){return this._responseType=e,this},i.prototype.serialize=function(e){return this._serializer=e,this},i.prototype.timeout=function(e){if(!e||\"object\"!=typeof e)return this._timeout=e,this._responseTimeout=0,this;for(var t in e)switch(t){case\"deadline\":this._timeout=e.deadline;break;case\"response\":this._responseTimeout=e.response;break;default:console.warn(\"Unknown timeout option\",t)}return this},i.prototype.retry=function(e,t){return 0!==arguments.length&&!0!==e||(e=1),e<=0&&(e=0),this._maxRetries=e,this._retries=0,this._retryCallback=t,this};var s=[\"ECONNRESET\",\"ETIMEDOUT\",\"EADDRINFO\",\"ESOCKETTIMEDOUT\"];i.prototype._shouldRetry=function(e,t){if(!this._maxRetries||this._retries++>=this._maxRetries)return!1;if(this._retryCallback)try{var n=this._retryCallback(e,t);if(!0===n)return!0;if(!1===n)return!1}catch(e){console.error(e)}if(t&&t.status&&t.status>=500&&501!=t.status)return!0;if(e){if(e.code&&~s.indexOf(e.code))return!0;if(e.timeout&&\"ECONNABORTED\"==e.code)return!0;if(e.crossDomain)return!0}return!1},i.prototype._retry=function(){return this.clearTimeout(),this.req&&(this.req=null,this.req=this.request()),this._aborted=!1,this.timedout=!1,this._end()},i.prototype.then=function(e,t){if(!this._fullfilledPromise){var n=this;this._endCalled&&console.warn(\"Warning: superagent request was sent twice, because both .end() and .then() were called. Never call .end() if you use promises\"),this._fullfilledPromise=new Promise(function(e,t){n.end(function(n,r){n?t(n):e(r)})})}return this._fullfilledPromise.then(e,t)},i.prototype.catch=function(e){return this.then(void 0,e)},i.prototype.use=function(e){return e(this),this},i.prototype.ok=function(e){if(\"function\"!=typeof e)throw Error(\"Callback required\");return this._okCallback=e,this},i.prototype._isResponseOK=function(e){return!!e&&(this._okCallback?this._okCallback(e):e.status>=200&&e.status<300)},i.prototype.get=function(e){return this._header[e.toLowerCase()]},i.prototype.getHeader=i.prototype.get,i.prototype.set=function(e,t){if(r(e)){for(var n in e)this.set(n,e[n]);return this}return this._header[e.toLowerCase()]=t,this.header[e]=t,this},i.prototype.unset=function(e){return delete this._header[e.toLowerCase()],delete this.header[e],this},i.prototype.field=function(e,t){if(null==e)throw new Error(\".field(name, val) name can not be empty\");if(this._data&&console.error(\".field() can't be used if .send() is used. Please use only .send() or only .field() & .attach()\"),r(e)){for(var n in e)this.field(n,e[n]);return this}if(Array.isArray(t)){for(var i in t)this.field(e,t[i]);return this}if(null==t)throw new Error(\".field(name, val) val can not be empty\");return\"boolean\"==typeof t&&(t=\"\"+t),this._getFormData().append(e,t),this},i.prototype.abort=function(){return this._aborted?this:(this._aborted=!0,this.xhr&&this.xhr.abort(),this.req&&this.req.abort(),this.clearTimeout(),this.emit(\"abort\"),this)},i.prototype._auth=function(e,t,n,r){switch(n.type){case\"basic\":this.set(\"Authorization\",\"Basic \"+r(e+\":\"+t));break;case\"auto\":this.username=e,this.password=t;break;case\"bearer\":this.set(\"Authorization\",\"Bearer \"+e)}return this},i.prototype.withCredentials=function(e){return null==e&&(e=!0),this._withCredentials=e,this},i.prototype.redirects=function(e){return this._maxRedirects=e,this},i.prototype.maxResponseSize=function(e){if(\"number\"!=typeof e)throw TypeError(\"Invalid argument\");return this._maxResponseSize=e,this},i.prototype.toJSON=function(){return{method:this.method,url:this.url,data:this._data,headers:this._header}},i.prototype.send=function(e){var t=r(e),n=this._header[\"content-type\"];if(this._formData&&console.error(\".send() can't be used if .attach() or .field() is used. Please use only .send() or only .field() & .attach()\"),t&&!this._data)Array.isArray(e)?this._data=[]:this._isHost(e)||(this._data={});else if(e&&this._data&&this._isHost(this._data))throw Error(\"Can't merge these send calls\");if(t&&r(this._data))for(var i in e)this._data[i]=e[i];else\"string\"==typeof e?(n||this.type(\"form\"),n=this._header[\"content-type\"],this._data=\"application/x-www-form-urlencoded\"==n?this._data?this._data+\"&\"+e:e:(this._data||\"\")+e):this._data=e;return!t||this._isHost(e)?this:(n||this.type(\"json\"),this)},i.prototype.sortQuery=function(e){return this._sort=void 0===e||e,this},i.prototype._finalizeQueryString=function(){var e=this._query.join(\"&\");if(e&&(this.url+=(this.url.indexOf(\"?\")>=0?\"&\":\"?\")+e),this._query.length=0,this._sort){var t=this.url.indexOf(\"?\");if(t>=0){var n=this.url.substring(t+1).split(\"&\");\"function\"==typeof this._sort?n.sort(this._sort):n.sort(),this.url=this.url.substring(0,t)+\"?\"+n.join(\"&\")}}},i.prototype._appendQueryString=function(){console.trace(\"Unsupported\")},i.prototype._timeoutError=function(e,t,n){if(!this._aborted){var r=new Error(e+t+\"ms exceeded\");r.timeout=t,r.code=\"ECONNABORTED\",r.errno=n,this.timedout=!0,this.abort(),this.callback(r)}},i.prototype._setTimeouts=function(){var e=this;this._timeout&&!this._timer&&(this._timer=setTimeout(function(){e._timeoutError(\"Timeout of \",e._timeout,\"ETIME\")},this._timeout)),this._responseTimeout&&!this._responseTimeoutTimer&&(this._responseTimeoutTimer=setTimeout(function(){e._timeoutError(\"Response timeout of \",e._responseTimeout,\"ETIMEDOUT\")},this._responseTimeout))}},function(e,t){\"use strict\";e.exports=function(e){return null!==e&&\"object\"==typeof e}},function(e,t,n){\"use strict\";var r=n(47);function i(e){if(e)return function(e){for(var t in i.prototype)e[t]=i.prototype[t];return e}(e)}e.exports=i,i.prototype.get=function(e){return this.header[e.toLowerCase()]},i.prototype._setHeaderProperties=function(e){var t=e[\"content-type\"]||\"\";this.type=r.type(t);var n=r.params(t);for(var i in n)this[i]=n[i];this.links={};try{e.link&&(this.links=r.parseLinks(e.link))}catch(e){}},i.prototype._setStatusProperties=function(e){var t=e/100|0;this.status=this.statusCode=e,this.statusType=t,this.info=1==t,this.ok=2==t,this.redirect=3==t,this.clientError=4==t,this.serverError=5==t,this.error=(4==t||5==t)&&this.toError(),this.accepted=202==e,this.noContent=204==e,this.badRequest=400==e,this.unauthorized=401==e,this.notAcceptable=406==e,this.forbidden=403==e,this.notFound=404==e}},function(e,t){\"use strict\";t.type=function(e){return e.split(/ *; */).shift()},t.params=function(e){return e.split(/ *; */).reduce(function(e,t){var n=t.split(/ *= */),r=n.shift(),i=n.shift();return r&&i&&(e[r]=i),e},{})},t.parseLinks=function(e){return e.split(/ *, */).reduce(function(e,t){var n=t.split(/ *; */),r=n[0].slice(1,-1);return e[n[1].split(/ *= */)[1].slice(1,-1)]=r,e},{})},t.cleanHeader=function(e,t){return delete e[\"content-type\"],delete e[\"content-length\"],delete e[\"transfer-encoding\"],delete e.host,t&&(delete e.authorization,delete e.cookie),e}},function(e,t){function n(){this._defaults=[]}[\"use\",\"on\",\"once\",\"set\",\"query\",\"type\",\"accept\",\"auth\",\"withCredentials\",\"sortQuery\",\"retry\",\"ok\",\"redirects\",\"timeout\",\"buffer\",\"serialize\",\"parse\",\"ca\",\"key\",\"pfx\",\"cert\"].forEach(function(e){n.prototype[e]=function(){return this._defaults.push({fn:e,arguments:arguments}),this}}),n.prototype._setDefaults=function(e){this._defaults.forEach(function(t){e[t.fn].apply(e,t.arguments)})},e.exports=n}])},e.exports=r()},function(e,t,n){\"use strict\";n.r(t);let r=document.querySelector.bind(document);class i{constructor(){throw new Error(\"Unable to Instantiate Transitions\")}static add(e,...t){const n=this.converter(t);Array.isArray(n)?n.forEach(t=>{t.classList.add(e)}):n.classList.add(e)}static remove(e,...t){const n=this.converter(t);Array.isArray(n)?n.forEach(t=>{t.classList.remove(e)}):n.classList.remove(e)}static contains(e,t){return this.converter(t).classList.contains(e)}static showHiddenToggle(...e){e.forEach(e=>{const t=this.converter(e);t.classList.contains(\"none\")?this.remove(\"none\",t):this.add(\"none\",t)})}static converter(e){const t=String(e).substring(0,1);return\"#\"===t||\".\"===t?r(e):e}static showHiddenAll(e,t){const n=(e,t)=>{this.add(\"none\",t),this.remove(\"none\",e)};Array.isArray(t)?t.forEach(t=>{n(e,t)}):n(e,t)}static addIsRemove(e,t,...n){const r=this.converter(e);n.forEach(e=>{this.remove(e,r)}),this.add(t,r)}static fade(e,...t){[...t].forEach(t=>{\"in\"===e?(this.contains(\"fade-out\",t)||this.contains(\"opacity\",t))&&this.addIsRemove(t,\"fade-in\",\"fade-out\",\"opacity\"):\"out\"===e&&(this.contains(\"fade-in\",t)||this.contains(\"opacity\",t))&&this.addIsRemove(t,\"fade-out\",\"fade-in\",\"opacity\")})}static spinner(e){const t=r(\"#js-modal-spinner\");e?setTimeout(()=>{this.remove(\"none\",t)},100):setTimeout(()=>{this.add(\"none\",t)},100)}}class s{constructor(e,t){this.connection=e,this.store=t}add(e){return new Promise((t,n)=>{let r=this.connection.transaction([this.store],\"readwrite\").objectStore(this.store);r.add(e),r.onsuccess=(()=>{t(\"Element added in \"+this.store)}),r.onerror=(()=>{n(\"Could not add element in \"+this.store)})})}read(){return new Promise((e,t)=>{let n=this.connection.transaction([this.store],\"readwrite\").objectStore(this.store);n.getAll().onsuccess=(t=>{e(t.target.result)}),n.onerror=(()=>{t(\"Could not read elements in \"+this.store)})})}delete(e,t){return new Promise((n,r)=>{let i=this.connection.transaction([this.store],\"readwrite\").objectStore(this.store).openCursor();i.onsuccess=(r=>{let i=r.target.result;if(\"listsDb\"===this.store)if(i){let t=i.value;t.name===e&&i.delete(t),i.continue()}else n(\"Deleted item from \"+this.store);else if(\"itemDb\"===this.store)if(i){let n=i.value;n.name===e&&n.category===t&&i.delete(n),i.continue()}else n(\"Deleted item from \"+this.store);else if(\"recordDb\"===this.store)if(console.log(data.name,data.category),i){let e=i.value;i.delete(e),i.continue()}else n(\"Deleted item from \"+this.store)}),i.onerror=(()=>{r(\"Could not Deleted from \"+this.store)})})}}class o extends s{constructor(e){super(e,\"itemDb\")}clearUnit(){return new Promise((e,t)=>{let n=[],r=this.connection.transaction([this.store],\"readwrite\").objectStore(this.store).openCursor();r.onsuccess=(t=>{let r=t.target.result;if(r){let e=r.value;e.unit=0,r.update(e),n.push(e),r.continue()}else e(n)}),r.onerror=(()=>{t(\"Could not update \"+this.store)})})}editItems(e){return new Promise((t,n)=>{let r=this.connection.transaction([this.store],\"readwrite\").objectStore(this.store).openCursor();r.onsuccess=(n=>{let r=n.target.result;if(r){let t=r.value;e.some(e=>{if(t.name===e.name&&t.category===e.category)return t=e.item,r.update(t),!0}),r.continue()}else t()}),r.onerror=(()=>{n(\"Could not update \"+this.store)})})}}class a extends s{constructor(e){super(e,\"listsDb\")}rename(e,t){return new Promise((n,r)=>{let i=this.connection.transaction([this.store],\"readwrite\").objectStore(this.store).openCursor();i.onsuccess=(r=>{let i=r.target.result;if(i){let n=i.value;n.name===e&&(n.name=t,i.update(n)),i.continue()}else n()}),i.onerror=(()=>{r(\"Could not openCursor list\")})})}update(e,t){return new Promise((n,r)=>{let i=this.connection.transaction([this.store],\"readwrite\").objectStore(this.store);i.openCursor().onsuccess=(r=>{let i=r.target.result;if(i){let n=i.value;n.name===e&&(n.items=t,n.qtdItems=t.length,i.update(n)),i.continue()}else n()}),i.onerror=(()=>{r(\"Could not update \"+this.store)})})}}class u{constructor(e,...t){this._titulo=e,this._buttons=t}modalModel(){return`<div class=\"modal__model column\">\\n        <h1>${this._titulo}</h1>\\n        <div class=\"modal__model-main column\">\\n         ${this.buttons()}\\n        </div>\\n    </div>`}buttons(){return this._buttons.map(e=>`\\n         <button class=\"modal__options\" id=\"modal${e}\">${e}</button>\\n         `).join(\"\")}template(){return this.modalModel()}update(e){e.innerHTML=this.template()}}let c=document.querySelector.bind(document);const l=c(\"#modal\"),d=e=>new u(e,\"Apagar\");class h{constructor(){throw new Error(\"Unable to Instantiate UnitHelper\")}static listener(e){c(\"#modalApagar\").onclick=(()=>{this.delete(e,event)})}static appear(e){d(e.name).update(l)}static disappear(){i.add(\"none\",l),l.innerHTML=\"\"}static delete(e,t){t.preventDefault(),ItemsModalMethods.delete(e)}}let p,f=document.querySelector.bind(document),g=document.querySelectorAll.bind(document);const m=f(\"#modal\");class y{constructor(){throw new Error(\"Unable to Instantiate UnitHelper\")}static listener(){g(\".list__item\").forEach(e=>{e.addEventListener(\"touchstart\",this.start.bind(this),{passive:!0}),e.addEventListener(\"touchend\",this.end.bind(this),{passive:!0})}),window.addEventListener(\"scroll\",e=>{this.end()},!1),m.onclick=h.disappear}static supportData(e){const t=e.currentTarget,n=t.closest(\".list__item\"),r=t.closest(\".list__items-category\");return{name:n.querySelector(\".list__item-name\").textContent,qtd:n.querySelector(\".qtd\").textContent,measure:n.querySelector(\".measure\").textContent,unit:n.querySelector(\".unit\").textContent,category:r.querySelector(\"h1\").textContent}}static start(e){const t=this.supportData(e);this.end(),p=setTimeout(()=>{navigator.vibrate(100),h.appear(t),h.listener(t),i.showHiddenToggle(m)},1e3)}static end(){clearTimeout(p)}}class v{constructor(){throw new Error(\"Unable to Instantiate UnitHelper\")}static dialogsPrompt(e,t,n){navigator.notification.prompt(e,t,n,[\"Adicionar\",\"Cancelar\"],\"\")}static dialogsAlert(e,t,n){navigator.notification.alert(e,t,n,\"Ok\")}static dialogsConfirm(e,t,n,...r){navigator.notification.confirm(e,t,n,[r[0],r[1]])}}class _{constructor(e){this._element=e}update(e){this._element.innerHTML=null===e?\"\":this.template(e)}}class b extends _{constructor(e){super(e)}template(e){return e.map(e=>`<option value=\"${e}\">${e}</option>`).join(\"\")}}class w extends _{constructor(e){super(e)}template(e){return e.map(e=>`\\n        <div class=\"list__items-category\">\\n        <h1>${e.name}</h1>\\n        <ul class=\"list__items column\">\\n            \\x3c!--Itens--\\x3e\\n               ${e.itemsCategory.map(e=>`\\n               <li class=\"list__item row\">\\n                <span class=\"list__item-name\">${e.name}</span>\\n                <div class=\"list__qtd row\">\\n                    <span class=\"qtd\">${e.qtd}</span><span class=\"measure\">${e.measure}</span>\\n                </div>\\n                \\x3c!--Change amount--\\x3e\\n                <div class=\"change-amount row\">\\n                    <a class=\"amount minus icon-amount change-buttons minus-button opacity\"></a>\\n                        <span  class=\"change-amount-span unit opacity \">${e.unit}</span>\\n                    <a class=\"amount plus icon-amount change-buttons plus-button\"></a>\\n                </div>`).join(\"\")}\\n                </li> \\n            </ul>\\n            </div>`).join(\"\")}}class C{constructor(){throw new Error(\"Unable to Instantiate FormatString\")}static capitalize(e,t){const n=e.substring(0,t);return n.substring(0,1).toUpperCase()+n.substring(1).toLowerCase()}}const k=[\"listsDb\",\"itemDb\",\"recordDb\"],S=1,P=\"easyList\";var x=null,T=null;class E{constructor(){throw new Error(\"Unable to Instantiate ConnectionFactory\")}static getConnection(){return new Promise((e,t)=>{let n=window.indexedDB.open(P,S);n.onupgradeneeded=(e=>{k.forEach(t=>{e.target.result.createObjectStore(t,{autoIncrement:!0})})}),n.onsuccess=(t=>{x||(x=t.target.result,T=x.close.bind(x),x.close=(()=>{throw new Error(\"You can not close the connection..\")})),e(x)}),n.onerror=(e=>{t(e.target.error.name)})})}static closeConnection(){x&&(T(),x=null)}}let O=document.querySelector.bind(document);class M{constructor(){throw new Error(\"Unable to Instantiate StickyView\")}static sticky(e){let t=0,n=null,r=[];\"list\"===e?(t=O(\"#js-page-list\").querySelector(\".header-list\").offsetHeight,n=O(\"#js-page-list\").querySelectorAll(\".list__items-category\")):\"shop\"===e&&(t=O(\"#js-page-shopping\").querySelector(\".header-list\").offsetHeight,n=O(\"#js-page-shopping\").querySelectorAll(\".list__items-category\")),n.forEach(e=>{let n=e.offsetTop-2*t,i=e.offsetHeight+n,s=e.querySelector(\"h1\");r.push([n,i,s])}),r[0][2].classList.add(\"fixed\"),this.listenEvent(r)}static listenEvent(e){window.addEventListener(\"scroll\",t=>{e.forEach(e=>{window.scrollY>=e[0]&&window.scrollY<e[1]?e[2].classList.add(\"fixed\"):e[2].classList.remove(\"fixed\")})},!1)}}class A{constructor(e,t,n,r,i,s){this._name=e,this._qtd=t,this._measure=n,this._unit=r,this._category=i,this._price=s}get name(){return this._name}get qtd(){return this._qtd}get measure(){return this._measure}get unit(){return this._unit}get category(){return this._category}get price(){return this._price}}let j=document.querySelectorAll.bind(document),q=(document.querySelectorAll.bind(document),[{name:\"Achocolatado\",qtd:800,measure:\"g\",unit:0,category:\"Alimentos\",price:\"00,00\"},{name:\"Açúcar\",qtd:5,measure:\"Kg\",unit:0,category:\"Alimentos\",price:\"00,00\"},{name:\"Amido de Milho\",qtd:500,measure:\"g\",unit:0,category:\"Alimentos\",price:\"00,00\"},{name:\"Arroz\",qtd:5,measure:\"Kg\",unit:0,category:\"Alimentos\",price:\"00,00\"},{name:\"Azeite\",qtd:400,measure:\"ml\",unit:0,category:\"Alimentos\",price:\"00,00\"},{name:\"Tempero Pronto\",qtd:100,measure:\"g\",unit:0,category:\"Alimentos\",price:\"00,00\"},{name:\"Oregano\",qtd:100,measure:\"g\",unit:0,category:\"Alimentos\",price:\"00,00\"},{name:\"Vinagre\",qtd:1,measure:\"L\",unit:0,category:\"Alimentos\",price:\"00,00\"},{name:\"Abacaxi\",qtd:1,measure:\"un\",unit:0,category:\"Frutas / Verduras\",price:\"00,00\"},{name:\"Limão\",qtd:2,measure:\"Kg\",unit:0,category:\"Frutas / Verduras\",price:\"00,00\"},{name:\"Maçã\",qtd:1,measure:\"Kg\",unit:0,category:\"Frutas / Verduras\",price:\"00,00\"},{name:\"Mamão\",qtd:1,measure:\"Kg\",unit:0,category:\"Frutas / Verduras\",price:\"00,00\"},{name:\"Maracujá\",qtd:500,measure:\"g\",unit:0,category:\"Frutas / Verduras\",price:\"00,00\"},{name:\"Melancia\",qtd:1,measure:\"un\",unit:0,category:\"Frutas / Verduras\",price:\"00,00\"},{name:\"Melão\",qtd:1,measure:\"un\",unit:0,category:\"Frutas / Verduras\",price:\"00,00\"},{name:\"Morango\",qtd:1,measure:\"un\",unit:0,category:\"Frutas / Verduras\",price:\"00,00\"},{name:\"Água mineral\",qtd:500,measure:\"ml\",unit:0,category:\"Bebidas\",price:\"00,00\"},{name:\"Cerveja\",qtd:350,measure:\"ml\",unit:0,category:\"Bebidas\",price:\"00,00\"},{name:\"Refrigerante\",qtd:2,measure:\"L\",unit:0,category:\"Bebidas\",price:\"00,00\"},{name:\"Suco\",qtd:500,measure:\"ml\",unit:0,category:\"Bebidas\",price:\"00,00\"},{name:\"Vinho\",qtd:1,measure:\"L\",unit:0,category:\"Bebidas\",price:\"00,00\"},{name:\"Água sanitária\",qtd:2,measure:\"L\",unit:0,category:\"Limpeza\",price:\"00,00\"},{name:\"Álcool\",qtd:1,measure:\"L\",unit:0,category:\"Limpeza\",price:\"00,00\"},{name:\"Amaciante\",qtd:2,measure:\"L\",unit:0,category:\"Limpeza\",price:\"00,00\"},{name:\"Desinfetante\",qtd:2,measure:\"L\",unit:0,category:\"Limpeza\",price:\"00,00\"},{name:\"Lâmpada\",qtd:1,measure:\"un\",unit:0,category:\"Limpeza\",price:\"00,00\"},{name:\"Lustra móveis\",qtd:1,measure:\"un\",unit:0,category:\"Limpeza\",price:\"00,00\"},{name:\"Palito de dente\",qtd:1,measure:\"un\",unit:0,category:\"Limpeza\",price:\"00,00\"},{name:\"Papel Alumínio\",qtd:1,measure:\"un\",unit:0,category:\"Limpeza\",price:\"00,00\"},{name:\"Vela\",qtd:1,measure:\"un\",unit:0,category:\"Limpeza\",price:\"00,00\"},{name:\"Absorvente\",qtd:1,measure:\"un\",unit:0,category:\"Higiene\",price:\"00,00\"},{name:\"Algodão\",qtd:1,measure:\"un\",unit:0,category:\"Higiene\",price:\"00,00\"},{name:\"Sabonete\",qtd:1,measure:\"un\",unit:0,category:\"Higiene\",price:\"00,00\"},{name:\"Shampoo\",qtd:1,measure:\"un\",unit:0,category:\"Higiene\",price:\"00,00\"},{name:\"Bife\",qtd:1,measure:\"Kg\",unit:0,category:\"Carnes\",price:\"00,00\"},{name:\"Carne de frango\",qtd:1,measure:\"Kg\",unit:0,category:\"Carnes\",price:\"00,00\"},{name:\"Carne Moída\",qtd:1,measure:\"Kg\",unit:0,category:\"Carnes\",price:\"00,00\"},{name:\"Linguiça\",qtd:1,measure:\"Kg\",unit:0,category:\"Carnes\"}]);class L{constructor(){throw new Error(\"Unable to Instantiate ItemFactory\")}static init(){E.getConnection().then(e=>new o(e).read().then(e=>{e.length<=0&&q.forEach(e=>{E.getConnection().then(t=>new o(t).add(e))})}))}static addItems(e){E.getConnection().then(t=>new o(t).add(e))}static activeItem(){let e=null,t=null,n=null,r=null,s=null;j(\".change-amount\").forEach(o=>{e=o.querySelector(\"span\"),(t=parseInt(e.textContent))>0&&(n=o.querySelector(\".plus-button\"),r=o.closest(\".list__item\"),s=o.querySelector(\".minus-button\"),i.add(\"plus--active\",n),i.fade(\"in\",s),i.fade(\"in\",e),i.addIsRemove(r,\"list__item--in\",\"list__item--out\"))})}static create(e,t,n,r,i,s){let o=t;\"\"===o&&(o=0);const a=new A(C.capitalize(e,18),o,n,r,i,s);return{name:a.name,qtd:a.qtd,measure:a.measure,unit:a.unit,category:a.category,price:a.price}}static validationItems(e,t){return new Promise((n,r)=>{let i=!1,s=null,a=null,u=null;(async()=>{(s=await E.getConnection().then(e=>new o(e).read())).some(n=>n.name===e&&n.category===t?(a=\"Esse item já exite na categoria, insira um novo item ou altere a categoria\",u=\"Item existente\",v.dialogsAlert(a,()=>{},u),i=!0):e.length<=2?(a=\"O item deve conter mais de 3 caracteres.\",u=\"Salvar item\",v.dialogsAlert(a,()=>{},u),i=!0,!0):void 0),n(i)})()})}}const N=document.querySelector.bind(document)(\"#title-page-list\");class I{constructor(){throw new Error(\"Unable to Instantiate UnitHelper\")}static edit(e){(async()=>{i.spinner(!0);let t=[],n=await E.getConnection().then(e=>new a(e).read());n.some(t=>{if(t.name===e)return n=t}),N.textContent=e,n.categories.forEach(e=>{n.items.forEach(e=>{const n={name:e.name,category:e.category,item:e};t.push(n)})}),await E.getConnection().then(e=>new o(e).editItems(t)),await Se.items(!1),i.showHiddenToggle(\"#js-page-index\",\"#js-page-list\"),M.sticky(\"list\"),L.activeItem(),i.spinner(!1)})()}static delete(e){i.showHiddenToggle(modal);v.dialogsConfirm(\"Deseja apagar \"+e+\" permanentemente?\",t=>{1==t&&(async()=>{(await E.getConnection().then(e=>new a(e).read())).some(t=>{if(t.name===e)return(async()=>{await E.getConnection().then(t=>new a(t).delete(e))})(),!0}),Se.lists(event)})()},\"Apagar lista:\",\"Ok\",\"Cancelar\")}static rename(e){i.showHiddenToggle(modal),v.dialogsPrompt(\"Novo nome:\",t=>{this.validationNameList(t,e)},\"Renomear lista\")}static validationNameList(e,t){let n=!1;const r=C.capitalize(e.input1,16);(async()=>{(await E.getConnection().then(e=>new a(e).read())).some(e=>{if(e.name===r)return n=!0}),r.length>=3?n?n&&v.dialogsPrompt(\"Nome já existe, insira um novo nome.\",e=>this.validationNameList(e,t),\"Salva lista\"):(async()=>{await E.getConnection().then(e=>new a(e).rename(t,r)),await Se.lists(event)})():r.length>=1&&r.length<=3?v.dialogsPrompt(\"A lista deve conter mais de 3 caracteres.\",e=>this.validationNameList(e,t),\"Salva lista\"):\"\"===r&&v.dialogsPrompt(\"O nome da lista não pode estar em branco.\",e=>this.validationNameList(e,t),\"Salva lista\")})()}}let D=document.querySelector.bind(document);const R=D(\"#modal\"),U=e=>new u(e,\"Editar\",\"Renomear\",\"Apagar\");class H{constructor(){throw new Error(\"Unable to Instantiate UnitHelper\")}static listener(){D(\"#modalEditar\").onclick=this.edit,D(\"#modalRenomear\").onclick=this.rename,D(\"#modalApagar\").onclick=this.delete}static appear(e){U(e).update(R)}static disappear(){i.add(\"none\",R),R.innerHTML=\"\"}static edit(e){e.preventDefault();const t=e.target.closest(\".modal__model\").querySelector(\"h1\").textContent;I.edit(t)}static delete(e){e.preventDefault();const t=e.target.closest(\".modal__model\").querySelector(\"h1\").textContent;I.delete(t)}static rename(e){e.preventDefault();const t=e.target.closest(\".modal__model\").querySelector(\"h1\").textContent;I.rename(t)}}class K{constructor(){throw new Error(\"Unable to Instantiate FormatCoin\")}static coin(e,t,n,r,i){i.preventDefault();let s=\"\",o=0,a=o,u=0,c=u,l=\"\",d=l,h=window.Event?i.which:i.keyCode;if(t===e.value&&(e.value=\"\"),13===h||8===h)return!0;if(s=String.fromCharCode(h),-1===\"0123456789\".indexOf(s))return!1;for(c=e.value.length,a=0;a<c&&(\"0\"==e.value.charAt(a)||e.value.charAt(a)==r);a++);for(d=\"\";a<c;a++)-1!=\"0123456789\".indexOf(e.value.charAt(a))&&(d+=e.value.charAt(a));if(0===(c=(d+=s).length))e.value=\"\";else if(1===c)e.value=\"0\"+r+\"0\"+d;else if(2===c)e.value=\"0\"+r+d;else if(c>2&&c<6){for(l=\"\",o=0,a=c-3;a>=0;a--)3==o&&(l+=n,o=0),l+=d.charAt(a),o++;for(e.value=\"\",a=(u=l.length)-1;a>=0;a--)e.value+=l.charAt(a);return e.value+=r+d.substr(c-2,c),!1}}static price(e){let t=e.replace(\",\",\".\");return parseFloat(t)}}class B{constructor(e,t){this._name=e,this._itemsCategory=t}get name(){return this._name}get itemsCategory(){return this._itemsCategory}}let G=document.querySelector.bind(document);class F{constructor(){throw new Error(\"Unable to Instantiate CategoryFactory\")}static createCategories(e){let t=[],n=[],r=null,i=null,s=null,o=null;return(t=this.removeDuplicates(e)).map(t=>{i=e.filter(e=>e.category===t),s=new B(t,i),r={name:s.name,itemsCategory:s.itemsCategory},n.push(r)}),o={nameCategories:t,categoriesAll:n}}static add(e){v.dialogsPrompt(\"Nome da categoria:\",t=>{this.validationCategory(t,e)},\"Adicionar categoria\")}static validationCategory(e,t){let n=!1,r=null,i=null,s=null;const a=FormatString.capitalize(e.input1,16);(async()=>{const e=await E.getConnection().then(e=>new o(e).read());if((r=this.createCategories(e).nameCategories).some(e=>{if(e===a)return n=!0}),a.length>=3)if(n)n&&(i=\"A categoria já existe, insira uma nova categoria.\",s=\"Adicionar Categoria\",v.dialogsPrompt(i,e=>this.validationCategory(e,t),s));else{const e=document.createElement(\"option\");e.text=a,t.add(e,t[0]),t.selectedIndex=\"0\"}else a.length>=1&&a.length<3?(i=\"A categoria deve conter mais de 3 caracteres.\",s=\"Adicionar Categoria\",v.dialogsPrompt(i,e=>{this.validationCategory(e,t)},s)):\"\"===a&&(i=\"O nome da categoria não pode estar em branco.\",s=\"Adicionar Categoria\",v.dialogsPrompt(i,e=>{this.validationCategory(e,t)},s))})()}static removeDuplicates(e){const t=[];return e.forEach(e=>{t.includes(e.category)||t.push(e.category)}),t}static renderSelect(){(async()=>{const e=await E.getConnection().then(e=>new o(e).read()),t=this.createCategories(e).nameCategories;new b(G(\"#js-select-category\")).update(t)})()}}let z=document.querySelector.bind(document);class ${constructor(){throw new Error(\"Unable to Instantiate UnitHelper\")}static edit(e){let t={name:z(\"#js-input-name\"),qtd:z(\"#js-input-qtd\"),measure:z(\"#js-select-measure\"),unit:z(\"#js-span-unit\"),category:z(\"#js-select-category\"),price:\"00,00\"};F.renderSelect(),i.showHiddenAll(\"#js-page-create-item\",\"#js-page-shopping\"),i.showHiddenToggle(e.modal),t.name.value=e.name.textContent,t.qtd.value=e.qtd.textContent,t.measure.value=e.measure.textContent,t.unit.value=e.unit.textContent,t.category.value=e.category.textContent,z(\"#js-title-create\").textContent=\"Editar\",console.log(t.category)}static delete(e){}}let V=document.querySelector.bind(document);class X{constructor(){throw new Error(\"Unable to Instantiate UnitHelper\")}static input(e){const t=V(\"#js-price\"),n=V(\"#js-total\"),r=V(\"#js-save-price\"),s=t.value,o=()=>{if(t.value<=0||\"\"===t.value)n.textContent=\"00,00\",i.add(\"filter\",r);else{let s=e.unit.textContent,o=parseFloat(t.value*s.replace(\",\",\".\")).toFixed(2);n.textContent=o.replace(\".\",\",\"),i.remove(\"filter\",r)}};t.addEventListener(\"keypress\",e=>{K.coin(t,s,\".\",\".\",e),o()},!1),t.addEventListener(\"input\",()=>{o()},!1)}static save(e){V(\"#js-save-price\").addEventListener(\"click\",()=>{const t=e.name.textContent,n=e.category.textContent,r=V(\"#js-total\"),s=e.price,o={category:e.category.textContent,measure:e.measure.textContent,name:e.name.textContent,price:r.textContent,qtd:e.qtd.textContent,unit:e.unit.textContent};if(Shop.upadateItemShop(e.listName,t,n,o),r.textContent<=0||\"00,00\"===r.textContent||\"\"===r.textContent)return s.textContent=r.textContent,i.add(\"none\",e.priceBlock),i.remove(\"list__item-shop--active\",e.target),void i.showHiddenToggle(e.modal);s.textContent=r.textContent,i.remove(\"none\",e.priceBlock),i.add(\"list__item-shop--active\",e.target),i.showHiddenToggle(e.modal)},!1)}}let W=document.querySelector.bind(document);const J=W(\"#js-modal-price\");class Q{constructor(){throw new Error(\"Unable to Instantiate UnitHelper\")}static listener(e,t){W(\"#modalEditar\").addEventListener(\"click\",()=>{this.edit(e,t)},!1),W(\"#modalApagar\").addEventListener(\"click\",()=>{this.delete(e,t)},!1)}static modal(e){return{modalItems:new ModalView(e,\"Editar\",\"Apagar\"),modalPriceView:new ModalPriceView(e)}}static appear(e){this.modal(e).modalItems.update(J)}static disappear(e){\"SECTION\"===e.target.tagName&&(i.add(\"none\",J),J.innerHTML=\"\")}static edit(e,t){t.preventDefault(),$.edit(e)}static delete(e,t){t.preventDefault(),$.delete(e),console.log(\"apagar\")}static input(e,t){t.preventDefault(),X.input(e)}static save(e,t){t.preventDefault(),X.save(e)}}let Y,Z=document.querySelector.bind(document);document.querySelectorAll.bind(document);const ee=Z(\"#js-modal-price\");class te{constructor(){throw new Error(\"Unable to Instantiate UnitHelper\")}static listener(){document.querySelectorAll(\".list__item-shop\").forEach(e=>{e.addEventListener(\"click\",this.open.bind(this),!1),e.addEventListener(\"touchstart\",this.start.bind(this),!1),e.addEventListener(\"touchend\",this.end.bind(this),!1)}),window.addEventListener(\"scroll\",e=>{this.end()},!1),ee.addEventListener(\"click\",e=>{Q.disappear(e)})}static support(e){const t=e.currentTarget,n=Z(\"#js-title-shop\").textContent,r=t.closest(\".list__items-category\"),i=t.querySelector(\".list__item-name-shop\"),s=t.querySelector(\".qtd\"),o=t.querySelector(\".measure\"),a=t.querySelector(\".unit\"),u=r.querySelector(\"h1\"),c=t.querySelector(\".list__price-shop\"),l=c.querySelector(\".priceText\");return{modal:ee,target:t,listName:n,name:i,qtd:s,measure:o,unit:a,category:u,priceBlock:c,price:l}}static open(e){e.preventDefault();const t=this.support(e),n={name:t.name.textContent,qtd:t.qtd.textContent,measure:t.measure.textContent,unit:t.unit.textContent,price:(K.price(t.price.textContent)/parseFloat(t.unit.textContent)).toFixed(2),total:t.price.textContent};Q.modal(ee).modalPriceView.update(n),Q.input(t,e),Q.save(t,e),i.showHiddenToggle(ee),Z(\"#js-price\").focus()}static start(e){let t=this.support(e);this.end(),Y=setTimeout(()=>{navigator.vibrate(100),Q.appear(t.name.textContent),Q.listener(t,e),i.showHiddenToggle(ee)},1e3)}static end(){clearTimeout(Y)}static itemsShopActive(){document.querySelectorAll(\".priceText\").forEach(e=>{const t=e.closest(\".list__price-shop\"),n=e.closest(\".list__item-shop\");\"00,00\"!=e.textContent||\"\"!=parseFloat(e.textContent)?(i.remove(\"none\",t),i.add(\"list__item-shop--active\",n)):(i.add(\"none\",t),i.remove(\"list__item-shop--active\",n))})}static upadateItemShop(e,t,n,r){(async()=>{const i=await E.getConnection().then(e=>new a(e).read());let s=null;i.some(i=>{i.name!==e||(s=i.items).some((e,i)=>{e.name===t&&e.category===n&&s.splice(i,1,r)})}),await E.getConnection().then(t=>new a(t).update(e,s))})()}static addItemShop(e){(async()=>{const t=await E.getConnection().then(e=>new a(e).read());let n=null;t.some(t=>{t.name!==e||(n=t.items).some((e,t)=>{e.name===nameItem&&e.category===categoryItem&&n.splice(t,1,objectUpdate)})}),await E.getConnection().then(t=>new a(t).update(e,n))})()}}class ne extends _{constructor(e){super(e)}template(e){return e.map(e=>`\\n        <div class=\"list__items-category\">\\n                                <h1>${e.name}</h1>\\n                                <ul class=\"list__items column\">\\n                                    \\x3c!--Items--\\x3e\\n                                    ${e.itemsCategory.map(e=>`\\n                                    <li class=\"list__item-shop row\">\\n                                        \\x3c!--Change amount--\\x3e\\n                                        <div class=\"change-amount-shop row\">\\n                                            <span class=\"unit\">${e.unit}</span>\\n                                        </div>\\n        \\n                                        <span class=\"list__item-name-shop name \">${e.name}</span>\\n                                        <div class=\"list__qtd-shop row\">\\n                                            <span class=\"qtd\">${e.qtd}</span><span class=\"measure\">${e.measure}</span>\\n                                        </div>\\n                                        \\n                                        <div class=\"list__price-shop row none\">\\n                                            <span>R$ \\n                                            &nbsp</span><span class=\"priceText\">${e.price}</span>\\n                                        </div>\\n                                        `).join(\"\")}\\n                                    </li>\\n                                </ul>\\n                                </div>`).join(\"\")}}let re,ie=document.querySelector.bind(document),se=document.querySelectorAll.bind(document);const oe=ie(\"#modal\"),ae=ie(\"#js-page-shopping\"),ue=ie(\"#js-page-index\"),ce=ie(\"#js-list-shop\"),le=ie(\"#js-title-shop\"),de=new ne(ce);class he{constructor(){throw new Error(\"Unable to Instantiate UnitHelper\")}static listener(){se(\".list-ready__list\").forEach(e=>{e.addEventListener(\"click\",this.open.bind(this),!1),e.addEventListener(\"touchstart\",this.start.bind(this),!1),e.addEventListener(\"touchend\",this.end.bind(this),!1)}),window.addEventListener(\"scroll\",e=>{this.end()},!1),oe.onclick=H.disappear}static supportName(e){return e.currentTarget.querySelector(\".list-name-text\").textContent}static open(e){let t=this.supportName(e),n=null;(async()=>{(n=await E.getConnection().then(e=>new a(e).read())).some(e=>{if(e.name===t){const n=F.createCategories(e.items).categoriesAll;return de.update(n),te.itemsShopActive(),i.showHiddenAll(ae,ue),M.sticky(\"shop\"),te.listener(),le.textContent=t,!0}})})()}static start(e){let t=this.supportName(e);this.end(),re=setTimeout(()=>{navigator.vibrate(100),H.appear(t),H.listener(),i.showHiddenToggle(oe)},1e3)}static end(){clearTimeout(re)}}let pe,fe,ge=document.querySelector.bind(document);class me{constructor(){throw new Error(\"Unable to Instantiate UnitHelper\")}static unitAtr(){this._button=document.querySelectorAll(\".amount\"),this._button.forEach(e=>{e.addEventListener(\"click\",this.unitPressClick.bind(this),!1),e.addEventListener(\"touchstart\",this.unitPressStart.bind(this),!1),e.addEventListener(\"touchend\",this.unitPressEnd.bind(this),!1)}),window.addEventListener(\"scroll\",e=>{this.unitPressEnd()},!1)}static unitAtrCreate(){this._button=document.querySelectorAll(\".amount-items\"),this._button.forEach(e=>{e.addEventListener(\"click\",this.unitPressClick.bind(this),!1),e.addEventListener(\"touchstart\",this.unitPressStart.bind(this),!1),e.addEventListener(\"touchend\",this.unitPressEnd.bind(this),!1)})}static changeUnit(e){let t=e.target;if(t.closest(\"div\").classList.contains(\"change-amount-items\")){let e=ge(\"#js-span-unit\");if(t.classList.contains(\"minus-button\")){let t=parseInt(e.textContent);t<=0?e.textContent=0:t>0&&(e.textContent=--t)}else if(t.classList.contains(\"plus-button\")){let t=parseInt(e.textContent);e.textContent=t>=999?999:++t}}else{let e=t.closest(\".list__items-category\"),n=e.querySelector(\"h1\").textContent,r=e.querySelector(\".qtd\").textContent,s=e.querySelector(\".measure\").textContent,a=t.closest(\".change-amount\"),u=a.querySelector(\".minus-button\"),c=a.querySelector(\".plus-button\"),l=a.querySelector(\"span\"),d=l.textContent,h=a.closest(\".list__item\"),p=h.querySelector(\".list__item-name\").textContent;t.classList.contains(\"minus-button\")&&(d<=1&&(i.fade(\"out\",u),i.fade(\"out\",l),i.addIsRemove(h,\"list__item--out\",\"list__item--in\"),c.classList.remove(\"plus--active\")),d<=0?(navigator.vibrate(0),l.textContent=0):d>0&&(l.textContent=--d)),t.classList.contains(\"plus-button\")&&(l.textContent=d>=999?d:++d,i.fade(\"in\",u),i.fade(\"in\",l),t.classList.add(\"plus--active\"),i.addIsRemove(h,\"list__item--in\",\"list__item--out\")),E.getConnection().then(e=>new o(e).read().then(e=>{e.some(e=>{let t=[],i={name:p,qtd:r,measure:s,price:\"00,00\",unit:d,category:n};if(t.push({name:p,category:n,item:i}),e.name===p&&e.category===n)return E.getConnection().then(e=>new o(e).editItems(t).then(()=>{this.activeButtonSave()})),!0})}))}}static unitPressClick(e){e.preventDefault(),navigator.vibrate(50),this.changeUnit(e)}static unitPressStart(e){this.unitPressEnd(),pe=setTimeout(()=>{Items.end(),fe=setInterval(()=>{this.changeUnit(e)},200)},500)}static unitPressEnd(){clearTimeout(pe),clearInterval(fe)}static activeButtonSave(){E.getConnection().then(e=>new o(e).read().then(e=>{let t=e.some(e=>e.unit>=1),n=ge(\"#header__save\");t?i.fade(\"in\",n):i.fade(\"out\",n)}))}static clearUnits(){return new Promise((e,t)=>{E.getConnection().then(t=>new o(t).clearUnit().then(t=>{e(t)}))})}}class ye extends _{constructor(e){super(e)}template(e){return e.map(e=>`              \\n        <li class=\"list-ready__list row\">\\n\\n                 <div class=\"list-ready__list-box row\">\\n        \\n                    <div class=\"list-ready__list-modal column\">\\n\\n                        <div class=\"list-ready__list-name row\">\\n                            <h1 class=\"list-name-text\">${e.name}</h1>\\n                        </div>\\n\\n                        <div class=\"list-ready__list-date row\">\\n                            <h2>Data: ${e.date}</h2>\\n                            <h2>Itens:${e.qtdItems}</h2>\\n                        </div>\\n\\n                    </div>\\n                </div>\\n                </li>`).join(\"\")}}let ve=document.querySelector.bind(document);const _e=ve(\"#js-list-empty\"),be=ve(\"#js-list-full\"),we=new ye(be),Ce=ve(\"#js-list\"),ke=new w(Ce);class Se{constructor(){throw new Error(\"Unable to Instantiate Load\")}static lists(){E.getConnection().then(e=>new a(e).read().then(e=>{e.length>0?(we.update(e.reverse()),he.listener(),i.add(\"none\",_e),i.remove(\"none\",be)):(we.update(null),i.add(\"none\",be),i.remove(\"none\",_e))}))}static items(e){return new Promise((t,n)=>{let r=null,i=null;(async()=>{e?(r=await me.clearUnits(),i=F.createCategories(r),ke.update(i.categoriesAll),t(null)):e||(r=await E.getConnection().then(e=>new o(e).read()),i=F.createCategories(r),ke.update(i.categoriesAll),t())})()})}static renderItems(e,t){return new Promise((n,r)=>{(async()=>{await this.items(e,t),me.unitAtr(),me.activeButtonSave(),y.listener(),L.activeItem(),n()})()})}}class Pe extends s{constructor(e){super(e,\"recordDb\")}}class xe extends _{constructor(e){super(e)}template(e){return e.map(e=>`\\n\\n        <li class=\"record-block__record column\">\\n        <div class=\"record__date row\">\\n            <span>${e.date}</span>\\n        </div>\\n\\n        <div class=\"record__data row\">\\n            <span>${e.name}</span>\\n            <span>${e.total}</span>\\n        </div>\\n\\n    </li>`).join(\"\")}}let Te=document.querySelector.bind(document),Ee=document.querySelectorAll.bind(document);class Oe{constructor(){throw new Error(\"Unable to Instantiate  Metodos \")}static createList(e,t,n,r){return new Promise((s,o)=>{(async()=>{i.spinner(!0),await Se.renderItems(n,r),i.showHiddenToggle(e,t),M.sticky(\"list\"),i.spinner(!1),s()})()})}static itemCreateLast(){return new Promise((e,t)=>{const n=Array.prototype.slice.call(Ee(\".list__items-category h1\"));E.getConnection().then(t=>new o(t).read().then(t=>{if(t.length>0){const r=t.pop(),i={name:r.name,category:r.category};n.some(t=>{if(t.textContent===i.category){return t.parentElement.querySelectorAll(\".list__item-name\").forEach(t=>{if(t.textContent===i.name){const n=t.offsetTop-25*t.offsetHeight;window.scroll(0,n),e(t)}}),!0}})}}))})}static init(){L.init(),Se.lists(),this.recordIsEmpty()}static recordIsEmpty(){const e=new xe(Te(\"#js-record-page__block\")),t=Te(\"#js-record-box\"),n=Te(\"#js-record-empty\");E.getConnection().then(r=>new Pe(r).read().then(r=>{r.length>0?(e.update(r),i.showHiddenAll(t,n)):i.showHiddenAll(n,t)}))}}class Me{constructor(e,t,n,r,i){this._name=e,this._qtdItems=t,this._date=n,this._items=r,this._categories=i}get name(){return this._name}get qtdItems(){return this._qtdItems}get date(){return this._date}get items(){return this._items}get categories(){return this._categories}}class Ae{constructor(){throw new Error(\"Unable to Instantiate FormatDate\")}static dateForText(e){let t=[e.getDate(),e.getMonth()+1,e.getFullYear(),e.getHours(),e.getMinutes()];return t.forEach((e,n)=>{e<=9&&t.splice(n,1,\"0\"+e)}),`${t[0]}/${t[1]}/${t[2]} - ${t[3]}:${t[4]}`}}let je=document.querySelector.bind(document);class qe{constructor(){throw new Error(\"Unable to Instantiate SaveList\")}static saveList(e,t,n){\"Nova Lista\"===e.textContent?v.dialogsPrompt(\"Nome da lista:\",e=>{this.validationSaveList(e)},\"Salvar lista\"):this.addList(e.textContent,t,n,!0)}static addList(e,t,n,r){let s=[],u=C.capitalize(e,16);E.getConnection().then(c=>new o(c).read().then(o=>{o.forEach(e=>{e.unit>0&&s.push(e)});let c=s.length;c>999&&(c=\"> 999\");let l=F.createCategories(s).nameCategories,d=new Me(u,c,Ae.dateForText(new Date),s,l),h={name:d.name,qtdItems:d.qtdItems,date:d.date,items:d.items,categories:d.categories};r&&E.getConnection().then(r=>new a(r).update(e,h).then(()=>{Se.lists(),v.dialogsAlert(\"Lista editada com sucesso.\",()=>{Se.items(t,n,!0),i.showHiddenToggle(je(\"#js-page-list\"),je(\"#js-page-index\"))},\"\")})),r||(E.getConnection().then(e=>new a(e).add(h)),Se.lists(),v.dialogsAlert(\"Lista Salva com sucesso.\",()=>{Se.items(t,n,!0),i.showHiddenToggle(je(\"#js-page-list\"),je(\"#js-page-index\"))},\"Parabéns!!!\"))}))}static validationSaveList(e){let t=C.capitalize(e.input1,16),n=!1;1==e.buttonIndex&&E.getConnection().then(e=>new a(e).read().then(e=>{e.some(e=>{if(e.name===t)return n=!0,!0;n=!1}),t.length>=3?n?n&&v.dialogsPrompt(\"Nome existente, insira um novo nome.\",e=>{this.validationSaveList(e)},\"Salva lista\"):qe.addList(t,!1):t.length>=1&&t.length<=3?v.dialogsPrompt(\"A lista deve conter mais de 3 caracteres.\",e=>{this.validationSaveList(e)},\"Salva lista\"):\"\"===t&&v.dialogsPrompt(\"O nome da lista não pode estar em branco.\",e=>{this.validationSaveList(e)},\"Salva lista\")}))}}var Le=document.querySelector.bind(document);let Ne=Le(\"#price-total\"),Ie=0,De=Le(\"#modal\");class Re{constructor(){throw new Error(\"Unable to Instantiate UnitHelper\")}static addPrince(e,t,n){Ie=0,this.openMoneytShop(event).then(r=>{parseInt(r.priceText.textContent)>0&&(e.value=parseInt(r.priceText.textContent)/parseInt(r.item.unit),t.textContent=e.value*parseInt(r.item.unit),n.classList.remove(\"filter\")),n.addEventListener(\"click\",e=>{if(e.preventDefault(),!n.classList.contains(\"filter\")){r.priceText.textContent=r.modalShop.querySelector(\".total\").textContent,r.blockPrice.classList.remove(\"none\"),r.modalShop.classList.add(\"none\"),r.blockItem.classList.add(\"green\"),document.querySelectorAll(\".priceText\").forEach(e=>{console.log(),Ie+=parseFloat(e.textContent)}),Ne.textContent=Ie.toFixed(2)}}),e.addEventListener(\"input\",()=>{\"\"===e.value||e.value<=0?(t.textContent=\"00,00\",n.classList.add(\"filter\")):(t.textContent=(e.value*parseInt(r.item.unit)).toFixed(2),n.classList.remove(\"filter\"))},!1)})}static delItem(e,t,n,r){r.preventDefault(),i.showHiddenToggle(De),v.dialogsConfirm(\"Deseja apagar \"+e+\" permanentemente?\",r=>{1==r?console.log(e,t,n):i.showHiddenToggle(De)},\"Apagar item:\",\"Ok\",\"Cancelar\")}static modalMoneyExit(e){\"SECTION\"===e.target.tagName&&Le(\"#modal-shop\").classList.add(\"none\")}static modalExit(e){\"SECTION\"===e.target.tagName&&(De.innerHTML=\"\",i.showHiddenToggle(De))}static finalize(e){let t={date:e,name:Le(\"#js-title-shop\").textContent,total:Ne=Le(\"#price-total\").textContent};E.getConnection().then(e=>new Pe(e).add(t))}}let Ue=document.querySelector.bind(document);class He{constructor(){throw new Error(\"Unable to Instantiate UnitHelper\")}static selectMenuListiner(e){const t=e,n=[t.home,t.record,t.setting],r=t.move,i=t.subMenuText,s=[].slice.call(document.querySelectorAll(\".page-menu\"));n.forEach(e=>{e.addEventListener(\"touchstart\",o=>{const a=o.currentTarget.offsetLeft;this.move(e,a,r,i),this.changePages(t,e,s),this.controlMove(n)},!1)})}static move(e,t,n,r){n.style.marginLeft=t+\"px\",r.textContent=e.getAttribute(\"title\")}static changePages(e,t,n){switch(t){case e.home:i.showHiddenAll(Ue(\"#js-home-page\"),n);break;case e.record:i.showHiddenAll(Ue(\"#js-record-page\"),n);break;case e.setting:i.showHiddenAll(Ue(\"#js-setting-page\"),n)}}static controlMove(e){e.forEach(e=>{e.style.pointerEvents=\"auto\"}),setTimeout(()=>{e.forEach(e=>{e.style.pointerEvents=\"auto\"})},300)}}class Ke extends _{constructor(e){super(e)}template(e){return`\\n        <div class=\"modal__model-shop column\">\\n            <div class=\"modal__model-border row\">\\n                <span>${e.name} - ${e.qtd} ${e.measure} - ${e.unit} unidade </span>\\n            </div>\\n            <div class=\"modal__model-main-shop row\">\\n                <div class=\"modal__price row\">\\n                    <span>R$</span>\\n                </div>\\n                \\n                <input type=\"number\" placeholder=\"00,00\" value=\"${e.price}\" id=\"js-price\" />\\n                <div class=\"modal__next  row\">\\n                    <button  class=\"icon-medium filter\" id=\"js-save-price\"></button>\\n                </div>\\n                \\n            </div>\\n            <div class=\"modal__model-border row\">\\n                <span>Total:&nbsp R$ &nbsp </span><span id=\"js-total\">${e.total}</span>\\n            </div>\\n        </div>`}}var Be=n(0);let Ge=document.querySelector.bind(document);let Fe=new class{constructor(){this._list=Ge(\"#js-list\"),this._listFullUl=Ge(\"#js-list-full\"),this._listShop=Ge(\"#js-list-shop\"),this._modalPrice=Ge(\"#js-modal-price\"),this._record=Ge(\"#js-record-page__block\"),this._inputs={name:Ge(\"#js-input-name\"),qtd:Ge(\"#js-input-qtd\"),measure:Ge(\"#js-select-measure\"),unit:Ge(\"#js-span-unit\"),category:Ge(\"#js-select-category\"),price:\"00,00\"},this._pageIndex=Ge(\"#js-page-index\"),this._pageList=Ge(\"#js-page-list\"),this._pageShopping=Ge(\"#js-page-shopping\"),this._pageCreateItem=Ge(\"#js-page-create-item\"),this._recordBox=Ge(\"#js-record-box\"),this._recordEmpty=Ge(\"#js-record-empty\"),this._titlePageList=Ge(\"#title-page-list\"),this._menus={home:Ge(\"#js-home\"),record:Ge(\"#js-record\"),setting:Ge(\"#js-setting\"),move:Ge(\"#js-menu-move\"),subMenu:Ge(\"#js-subMenu\"),subMenuText:Ge(\"#js-subMenuText\")},this._clickSave=!1,this._date=Ae.dateForText(new Date),this._select=new b(this._inputs.category),this._listView=new w(this._list),this._ListAllView=new ye(this._listFullUl),this._listShopView=new ne(this._listShop),this._modalPriceView=new Ke(this._modalPrice),this._recordView=new xe(this._record),this._pubnub=Be.PUBNUB.init({publish_key:\"demo\",subscribe_key:\"demo\",error:function(e){console.log(\"Error:\",e)}}),this.init(),He.selectMenuListiner(this._menus),me.unitAtrCreate()}init(){Oe.init(),Oe.recordIsEmpty(),this._pubnub.publish({channel:\"my_channel\",message:\"Hello from the PubNub Javascript SDK!\",callback:function(e){console.log(e)}})}buttonSaveList(e){e.preventDefault(),qe.saveList(this._titlePageList,this._select,this._listView),this._pubnub.subscribe({channel:\"my_channel\",message:function(e){console.log(e)},connect:function(e){pubnub.publish({channel:\"my_channel\",message:\"Hello from the PubNub Javascript SDK\"})}})}buttonAddCategory(e){e.preventDefault(),F.add(this._inputs.category)}saveItem(){let e=null,t=null;(async()=>{(e=await L.validationItems(this._inputs.name.value,this._inputs.category.value))?this._inputs.name.focus():(t=L.create(this._inputs.name.value,this._inputs.qtd.value,this._inputs.measure.value,this._inputs.unit.textContent,this._inputs.category.value,this._inputs.price),\"Editar item\"===Ge(\"#js-title-create\").textContent?(async()=>{})():L.addItems(t),this.emptyInputs())})()}emptyInputs(){this._inputs.name.value=\"\",this._inputs.qtd.value=\"\",this._inputs.unit.textContent=\"1\",this._inputs.name.focus()}buttonBackShop(e){e.preventDefault(),i.showHiddenToggle(this._pageIndex,this._pageShopping)}buttonBackCreateItem(e){e.preventDefault(),(async()=>{await Oe.createList(this._pageCreateItem,this._pageList,this._listView,!1,e),this._clickSave&&(await Oe.itemCreateLast(),this._clickSave=!1)})()}buttonCreateItem(e){e.preventDefault(),F.renderSelect(),i.showHiddenToggle(this._pageCreateItem,this._pageList)}createItem(e){e.preventDefault();let t=null,n=null;(async()=>{t=await E.getConnection().then(e=>new o(e).read()),n=F.createCategories(t),this._select.update(n.nameCategories)})(),i.showHiddenToggle(this._pageCreateItem,this._pageList),this.emptyInputs()}buttonBackList(e){e.preventDefault(),Ge(\"#header__save\").classList.contains(\"fade-out\")?(i.showHiddenToggle(this._pageIndex,this._pageList),Se.items(this._select,this._listView,!0)):v.dialogsConfirm(\"A lista não foi salva. Deseja salvar?:\",t=>{1===t?qe.saveList(e):(Ge(\"#header__save\").classList.add(\"fade-out\"),i.showHiddenToggle(this._pageIndex,this._pageList),Se.items(this._select,this._listView,!0))},\"Lista não salva:\",\"Sim\",\"Não\")}buttonClearRecord(e){e.preventDefault(),v.dialogsConfirm(\"Deseja apagar todos os registros?\",e=>{1===e&&(E.getConnection().then(e=>new Pe(e).delete()),Ge(\"#js-record-page__block\").innerHTML=\"\",this._recordView.update(null),i.showHiddenToggle(\"#js-page-menu-box\",\"#js-record-empty\"))},\"Apagar registros:\",\"Sim\",\"Não\")}buttonAddShop(e){e.preventDefault(),console.log(\"add\")}buttonSaveItem(e){e.preventDefault(),this.saveItem(),this._clickSave=!0}buttonCreateList(e){e.preventDefault(),Ge(\"#title-page-list\").textContent=\"Nova Lista\",Oe.createList(this._pageIndex,this._pageList,this._listView,!0,e)}finalizeShop(e){e.preventDefault(),Re.finalize(this._date),E.getConnection().then(e=>new Pe(e).read().then(e=>{this._recordView.update(e)})),v.dialogsAlert(\"Lista finalizada com sucesso.\",()=>{i.showHiddenToggle(this._pageShopping,this._pageIndex),this._recordEmpty.classList.add(\"none\")},\"Parabéns!!!\")}};let ze=document.querySelector.bind(document),$e=Fe;ze(\"#js-plus-add-list\").onclick=$e.buttonCreateList.bind($e),ze(\"#js-clear-record\").onclick=$e.buttonClearRecord.bind($e),ze(\"#js-back-page-list\").onclick=$e.buttonBackList.bind($e),ze(\"#js-save-list\").onclick=$e.buttonSaveList.bind($e),ze(\"#js-add-item\").onclick=$e.buttonCreateItem.bind($e),ze(\"#js-back-page-shopping\").onclick=$e.buttonBackShop.bind($e),ze(\"#js-add-item-shop\").onclick=$e.buttonAddShop.bind($e),ze(\"#js-finalize-shop\").onclick=$e.finalizeShop.bind($e),ze(\"#js-back-create-item\").onclick=$e.buttonBackCreateItem.bind($e),ze(\"#js-save-item\").onsubmit=$e.buttonSaveItem.bind($e),ze(\"#js-add-category\").onclick=$e.buttonAddCategory.bind($e)}]);","extractedComments":[]}